
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pandas DataFrames &#8212; Data Science for Psychology and Neuroscience — in Python</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e2363ea40746bee74734a24ffefccd78.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="http://neuraldatascience.io/3/pandas-dataframes.html" />
    <link rel="shortcut icon" href="../_static/NESC3505_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Looping Over Data Files" href="looping-data-files.html" />
    <link rel="prev" title="Conditionals" href="conditionals.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/NESC3505_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Science for Psychology and Neuroscience — in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About This Course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1/why.html">
   Start with why
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/learning_objectives.html">
   Learning Objectives for this Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Pedagogy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1/teaching_approach.html">
   Teaching Approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/online_learning.html">
   Hybrid Online Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/assessment_evaluation.html">
   Assessment and Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/constructivism.html">
   Constructivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/connectivism.html">
   Connectivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/authenticity.html">
   Authenticity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/21st_cen_skills.html">
   21st Century Skills
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Open Software, Science, &amp; Education
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1/open.html">
   Open Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/software.html">
   Free Software
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/free_licenses.html">
   Free and Open-Source Software Licenses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/open_science.html">
   Open Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/peer_review.html">
   Peer Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/for_profit.html">
   For-Profit Publishing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/impact_factors.html">
   Impact Factors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/novelty.html">
   Novelty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/open_publishing.html">
   Open Publishing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/preregistration.html">
   Preregistration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/open_methods.html">
   Open Methods and Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/oer.html">
   Open Educational Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/oer_this_course.html">
   OERs in the Context of this Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/licenses.html">
   Licenses
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  How to Rock This Course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1/learning_approach.html">
   Learning Approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/mindset.html">
   Mindset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/errors_debugging.html">
   Errors and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1/teamwork.html">
   Collaboration and Teamwork
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../2/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2/what_is_nds.html">
   What is Data Science?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/data.html">
     Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2/tools_for_nds.html">
   Tools for Neural Data Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/spreadsheets.html">
     Spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/spreadsheets_limits.html">
     Limitations of Spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/reproducibility.html">
     Reproducibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/sci_prog_lang.html">
     Scientific Programming Languages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/which_lang.html">
     Which language to use?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/libs.html">
     Libraries and packages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/why_python.html">
     Why Python for this Course?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2/class_tech.html">
   Technologies Used in this Class
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/lms.html">
     Learning Management System
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/teams.html">
     MS Teams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/communication.html">
     Communication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/videos.html">
     YouTube
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2/coding.html">
   Coding Tools
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/python.html">
     Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/datacamp.html">
     DataCamp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/py4e.html">
     Python for Everybody (PY4E)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/terminal.html">
     The Terminal and Command Line
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/jupyter.html">
     Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/markdown.html">
     Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/cocalc.html">
     CoCalc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2/github.html">
     GitHub
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2/alltogether.html">
   Putting It All Together
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2/get_going.html">
   Get Going!
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introducing Python
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="getting_help.html">
   Getting Help with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variables-and-assignment.html">
   Variables and Assignment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="types-conversion.html">
   Data Types and Conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="built-in.html">
   Python Built-Ins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lists.html">
   Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Dictionaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="for-loops.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="conditionals.html">
   Conditionals
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="looping-data-files.html">
   Looping Over Data Files
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Visualizing Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/introduction.html">
   Introduction to Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/proc-vs-oo.html">
   Procedural versus Object-Oriented Plotting in Matplotlib
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Single Unit Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/single_unit_intro.html">
   Single Unit Data and Spike Trains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/intro_spike_trains.html">
   Introduction to Spike Train Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/ten_intensities.html">
   Ten intensities — A bigger data set
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/heat_maps.html">
   Heat Maps, Interpolation, and Colour Map Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/intro_multielec_data.html">
   Introducing Multielectrode Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/import_multielec_data.html">
   Importing Multielectrode Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/pandas_multielec.html">
   Working with Multielectrode Data in pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../single_unit/corr_spike_trains.html">
   Correlating spike trains
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  EEG Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../eeg/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eeg/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eeg/time_freq.html">
   Time and Frequency Domains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eeg/erps.html">
   Event-Related Potentials (ERPs)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../eeg/components.html">
   ERP Components
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../eeg/preprocessing.html">
   Preprocessing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/filtering.html">
     Filtering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/event_codes.html">
     Event Codes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/epoching.html">
     Epoching (Segmentation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/artifacts.html">
     Artifacts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/averaging.html">
     Averaging
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../eeg/mne-python.html">
   MNE-Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/mne_org.html">
     Organization of MNE-Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../eeg/mne_classes.html">
     MNE classes
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  MRI Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mri/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mri/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../zrefs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/3/pandas-dataframes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/DalPsychNeuro/NESC_3505_textbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/DalPsychNeuro/NESC_3505_textbook/issues/new?title=Issue%20on%20page%20%2F3/pandas-dataframes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DalPsychNeuro/NESC_3505_textbook/master?urlpath=tree/3/pandas-dataframes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   pandas DataFrames
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#questions">
     Questions:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-objectives">
     Learning Objectives:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-pandas">
     What is pandas?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#about-python-libraries">
     About Python Libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-with-pandas">
     Importing data with pandas
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heads-or-tails">
     Heads or Tails?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-values-in-a-dataframe">
     Accessing values in a DataFrame
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-indexing-using-iloc">
       Numerical indexing using
       <code class="docutils literal notranslate">
        <span class="pre">
         .iloc[]
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#label-based-indexing-using-loc">
     Label-based indexing using
     <code class="docutils literal notranslate">
      <span class="pre">
       .loc[]
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-on-its-own-to-mean-all-columns-or-all-rows">
     Use
     <code class="docutils literal notranslate">
      <span class="pre">
       :
      </span>
     </code>
     on its own to mean all columns or all rows.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slicing-works-on-dataframes">
     Slicing works on DataFrames
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-lists-to-select-non-contiguous-sections-of-a-dataframe">
     Use lists to select non-contiguous sections of a DataFrame
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#it-s-easy-to-do-simple-math-and-statistics-in-dataframes">
     It’s easy to do simple math and statistics in DataFrames
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mini-exercise">
       Mini-Exercise
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-cells-based-on-conditions">
     Evaluate cells based on conditions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-values-or-nan-using-a-boolean-mask">
     Select values or NaN using a Boolean mask.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-apply-combine">
     Split-Apply-Combine
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#split">
       Split
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#apply">
       Apply
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combine">
       Combine
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#chaining">
       Chaining
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-individual-values">
     Selecting Individual Values
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extent-of-slicing">
     Extent of Slicing
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#answer">
       Answer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reconstructing-data">
     Reconstructing Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution">
     Solution
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-indices">
     Selecting Indices
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Solution
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#practice-with-selection">
     Practice with Selection
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-the-dir-function-to-see-available-methods">
     Using the
     <code class="docutils literal notranslate">
      <span class="pre">
       dir
      </span>
     </code>
     function to see available methods
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretation">
     Interpretation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary-of-key-points">
   Summary of Key Points:
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <img src="https://pandas.pydata.org/static/img/pandas.svg" width=200px>
<div class="section" id="pandas-dataframes">
<h1>pandas DataFrames<a class="headerlink" href="#pandas-dataframes" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><span class="xref myst">Watch a walk-through of this lesson on YouTube</span></p>
<div class="section" id="questions">
<h2>Questions:<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>How do I read in data from a file?</p></li>
<li><p>How can I work with data in tabular format (tables)?</p></li>
<li><p>How can I do basic descriptive statistics on tabular data?</p></li>
</ul>
</div>
<div class="section" id="learning-objectives">
<h2>Learning Objectives:<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Select individual values from a Pandas dataframe</p></li>
<li><p>Select entire rows or entire columns from a dataframe</p></li>
<li><p>Select a subset of both rows and columns from a dataframe in a single operation</p></li>
<li><p>Select a subset of a dataframe by a single Boolean criterion</p></li>
<li><p>Obtain descriptive statistics for subsets of data within a table</p></li>
<li><p>Use the split-apply-combine paradigm to work with data</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="what-is-pandas">
<h2>What is pandas?<a class="headerlink" href="#what-is-pandas" title="Permalink to this headline">¶</a></h2>
<p>Bad news first: there are no cute, black-and-white bears here. <a class="reference external" href="https://pandas.pydata.org/docs/">pandas</a> (whose official name starts with a lower-case “p”) is a Python <em>library</em> for working with data in a tabular format, such as is found in file formats like CSV, Microsoft Excel, and Google Sheets. Unlike Excel or Sheets, pandas is not a point-and click graphical interface for working with these files — everything is done through Python code. But compared to other formats for working with data that we have seen in this workshop, such as lists and dictionaries, pandas may seem more familiar, and it definitely lends itself more naturally to large data sets. Indeed, pandas’ mission statement is, “…to be the fundamental high-level building block for doing practical, real world data analysis in Python”.</p>
<p>The primary units of pandas data storage you will work with are <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/01_table_oriented.html#min-tut-01-tableoriented">DataFrames</a> (essentially, tables of data organized as rows and columns). DataFrames are actually collections of pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html">Series</a> objects, which can be thought of as individual rows or columns (or vectors, or 1D arrays).</p>
<p>Among the things that make pandas so attractive are the powerful interface to access individual records of the table, proper handling of missing values, and relational-databases operations between DataFrames. As well, pandas functions and methods are written to work intuitively and efficiently with data organized in tables. Most operations are <em>vectorized</em>, which means that they will automatically apply to all values in a DataFrame or Series without the need to write <code class="docutils literal notranslate"><span class="pre">for</span></code> loops to execute the same operation on a set of cells.</p>
<p>pandas is built on top of the <a class="reference external" href="https://numpy.org">NumPy</a> library. Although we haven’t discussed NumPy in this workshop, it is a powerful and widely used Python library for working with numerical data. However, it’s worth noting for your future reference that most of the methods defined for NumPy Arrays also apply to Pandas Series/DataFrames.</p>
</div>
<div class="section" id="about-python-libraries">
<h2>About Python Libraries<a class="headerlink" href="#about-python-libraries" title="Permalink to this headline">¶</a></h2>
<p>pandas is an example of a Python library. A <strong>library</strong> is a collection of files (called <em>modules</em>) that contains functions for use by other programs. Libraries provide ways of extending Python’s functionality in different ways. They may also contain data values (e.g., numerical constants), entire sample data sets, and other things. A library’s contents are supposed to be related, although there’s no actual way to enforce that.</p>
<p>The Python <a class="reference external" href="https://docs.python.org/3/library/">standard library</a> is an extensive suite of modules that comes with Python itself. Everything we’ve done so far in this workshop has been part of the standard library. Many additional libraries are available; CoCalc has a large number of extra libraries already installed.</p>
<p>To use a library in a particular Jupyter notebook or other Python program, we must import it using the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
<p>Once a library is imported, we can use functions and methods from it. But, for functions we have to tell Python that the function can be found in a particular library we imported. For example, pandas has a function to import data from CSV (comma-separated value) files, called <code class="docutils literal notranslate"><span class="pre">read_csv</span></code>. To run this command, we would need to type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">()</span>
</pre></div>
</div>
<p>Since some package names are long, and adding the name to every function can result in a lot of typing, Python also allows us to assign an <em>alias</em> — a shorter name — to a library when we import it. For example, the convention for pandas is to give it the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code> like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p>Then to read a CSV file we could use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">()</span>
</pre></div>
</div>
<p>In the cell below, import pandas with the alias pd:</p>
</div>
<div class="section" id="importing-data-with-pandas">
<h2>Importing data with pandas<a class="headerlink" href="#importing-data-with-pandas" title="Permalink to this headline">¶</a></h2>
<p>As noted, we can read a CSV file and use it to create a pandas DataFrame, with the funciton <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code>. <a class="reference external" href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a> is a text format used for storing tabular data, in which each line of the file corresponds to a row in the table, and columns are separated with commas (“CSV” stands for “comma-separated values”). Often the first row of a CSV file will be the <em>header</em>, containing labels for each column.</p>
<p>The Gapminder data is in CSV format, so let’s load in one of the Gapminder datasets with the command below. Note that when we read in a DataFrame, we need to assign it to a variable name so that we can reference it later. A convention when working with pandas is to call the DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code>. This works fine if you only have one DataFrame to work with, although if you are working with multiple DataFrames it is a good idea to give them more meaningful names.</p>
<p>The Gapminder data are stored in a subfolder called <code class="docutils literal notranslate"><span class="pre">data</span></code>, so as the argument to <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> below we give the folder name folled by a slash, then the file name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/gapminder_gdp_europe.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can view the contents of the DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code> by simply typing its name and running the cell. Note that, unlike most of the examples we’ve used in previous lessons, we <em>don’t</em> use the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function. Although it works, the result is not nicely formatted the way the output is if we just use the name of the data frame.</p>
<p>That is, run this command: <code class="docutils literal notranslate"><span class="pre">df</span></code> — not <code class="docutils literal notranslate"><span class="pre">print(df)</span></code> — in the cell below.</p>
<p>You’ll see that the rows are numbered in boldface, starting with 0 as is the norm in Python. This boldfaced, leftmost column is called the <strong>index</strong> of the DataFrame, and provides one way of accessing data by rows. Across the top, you’ll see that the column labels are also in boldface. pandas is pretty smart about automatically detecting when the first row of a CSV file contains header information (column names).</p>
</div>
<div class="section" id="heads-or-tails">
<h2>Heads or Tails?<a class="headerlink" href="#heads-or-tails" title="Permalink to this headline">¶</a></h2>
<p>We might want to “peek” at the DataFrame without printing out the entire thing, especially if it’s big. We can see the first 5 rows of a DataFrame with the <code class="docutils literal notranslate"><span class="pre">.head()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>…or the last 5 rows with <code class="docutils literal notranslate"><span class="pre">.tail()</span></code>:</p>
<p>We can also see a random sample of rows from the DataFrame with <code class="docutils literal notranslate"><span class="pre">.sample()</span></code>, giving it a numerical argument to indicate the number of rows we want to see:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">.tail()</span></code> methods also optionally take a numerical argument, if you want to view a different number of rows from teh default of 5.</p>
</div>
<div class="section" id="accessing-values-in-a-dataframe">
<h2>Accessing values in a DataFrame<a class="headerlink" href="#accessing-values-in-a-dataframe" title="Permalink to this headline">¶</a></h2>
<p>One thing we often want to do is access a single cell in a DataFrame, or a range of cells. Each cell is uniquely defined by a combination of its row and column locations.</p>
<div class="section" id="numerical-indexing-using-iloc">
<h3>Numerical indexing using <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code><a class="headerlink" href="#numerical-indexing-using-iloc" title="Permalink to this headline">¶</a></h3>
<p>pandas provides two ways of accessing cell locations. One is using the numerical positions in the DataFrame, using the convention of [row, column] — with [0, 0] being the top left cell in the DataFrame. So for a pandas DataFrame with 3 rows and 3 columns, the indices of each cell are as shown:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>col 0</p></th>
<th class="head"><p>col 1</p></th>
<th class="head"><p>col 2</p></th>
<th class="head"><p>col 3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>[0, 0]</p></td>
<td><p>[0, 1]</p></td>
<td><p>[0, 2]</p></td>
<td><p>[0, 3]</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>[1, 0]</p></td>
<td><p>[1, 1]</p></td>
<td><p>[1, 2]</p></td>
<td><p>[1, 3]</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>[2, 0]</p></td>
<td><p>[2, 1]</p></td>
<td><p>[2, 2]</p></td>
<td><p>[2, 3]</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>[3, 0]</p></td>
<td><p>[3, 1]</p></td>
<td><p>[3, 2]</p></td>
<td><p>[3, 3]</p></td>
</tr>
</tbody>
</table>
<p>Numerical indexing of DataFrames is done with the <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> method. For example, to access the GDP value for Austria in 1952 — which is located in the second row, third column of our current DataFrame, we would use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="label-based-indexing-using-loc">
<h2>Label-based indexing using <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code><a class="headerlink" href="#label-based-indexing-using-loc" title="Permalink to this headline">¶</a></h2>
<p>The other way to access a location in a DataFrame is by its index and column <em>labels</em>, using the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> method. As noted earlier, in the DataFrame we imported, the indexes are currently numbers, which were created automatically when we imported the data. The <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> method doesn’t work with numerical indexes (that’s what <code class="docutils literal notranslate"><span class="pre">iloc</span></code> is for — and you can’t mix, say, a numerical row index with a column label), but in the data set we imported, the first column of this CSV file is actually meant to be its index: while all other columns are data values (GDP, in type float), the first column identifies the country with which each row of data is associated.</p>
<p>pandas has a method for setting an index column, <code class="docutils literal notranslate"><span class="pre">.set_index()</span></code>, where the argument (in the parentheses) would be the name of the column to use as the index. So here we want to run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note</strong> that we need to assign the result of this operation back to <code class="docutils literal notranslate"><span class="pre">df</span></code> (using <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> </code>), otherwise the change will not actually modify <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<p>In the cell below, use the <code class="docutils literal notranslate"><span class="pre">.set_index()</span></code> method to set the index of <code class="docutils literal notranslate"><span class="pre">df</span></code> to <code class="docutils literal notranslate"><span class="pre">country</span></code>, and then view the DataFrame again to see how it has changed.</p>
<p>Alternatively, if we knew which column we wanted to use as the index before loading in the data file, we could have included the argument <code class="docutils literal notranslate"><span class="pre">index_col=</span></code> in the <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/gapminder_gdp_europe.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have defined the index, we can access the 1952 GDP value for Austria by its index and column names:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Austria&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_1952&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="use-on-its-own-to-mean-all-columns-or-all-rows">
<h2>Use <code class="docutils literal notranslate"><span class="pre">:</span></code> on its own to mean all columns or all rows.<a class="headerlink" href="#use-on-its-own-to-mean-all-columns-or-all-rows" title="Permalink to this headline">¶</a></h2>
<p>Using Python’s familiar slicing notatio (which we’ve previously used for strings and lists), we can use <code class="docutils literal notranslate"><span class="pre">:</span></code> with <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> or <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>, to specify a range in a DataFrame.</p>
<p>For example, to see the GDP of Albania for every year (column) in the DataFrame, we would use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Albania&quot;</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<p>Likewise, we could see the GDP for every country (row) in the year 1957 with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;gdpPercap_1957&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>You can also just specify the row index; if you don’t specify anything for the columns, pandas assumes you want all columns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Albania&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>However, since the syntax for <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> is [rows, columns], you cannot omit a row index; you need to use <code class="docutils literal notranslate"><span class="pre">:</span></code> if you want all rows.</p>
</div>
<div class="section" id="slicing-works-on-dataframes">
<h2>Slicing works on DataFrames<a class="headerlink" href="#slicing-works-on-dataframes" title="Permalink to this headline">¶</a></h2>
<p>Slicing using numerical indices works similarly for DataFrames as we previously saw for strings and lists, for example, the following code will print the third through fifth rows of the DataFrame, and the fifth through eighth columns (remember, Python indexing starts at 0, and slicing does not include the “end” index):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>The code below will print from the sixth to second-last row of the DataFrame, and from the ninth to the last column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:]</span>
</pre></div>
</div>
<p><strong>Note</strong> however, that when using label-based indexing with <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>, pandas’ slicing behaviour is a bit different. Specifically, the output <em>includes</em> the last item in the range, whereas numerical indexing with <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> does not.</p>
<p>So, considering that the first three rows of the DataFrame correspond to the countries Albania, Austria, and Belgium, and that columns 6 and 7 are for the years 1982 and 1987 respectively, compare the output of:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<p>with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Albania&#39;</span><span class="p">:</span><span class="s1">&#39;Belgium&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_1982&#39;</span><span class="p">:</span><span class="s1">&#39;gdpPercap_1988&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The “inclusive” label-based indexing with <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> is fairly intuitive, but it’s important to remember that it works differently from numerical indexing.</p>
</div>
<div class="section" id="use-lists-to-select-non-contiguous-sections-of-a-dataframe">
<h2>Use lists to select non-contiguous sections of a DataFrame<a class="headerlink" href="#use-lists-to-select-non-contiguous-sections-of-a-dataframe" title="Permalink to this headline">¶</a></h2>
<p>While slicing can be very useful, sometimes we might want to extract values that aren’t next to each other in a DataFrame. For example, what if we only want values from two specific years (1992 and 2002), for Scandinavian countries (Denmark, Finland, Norway, and Sweden)? Nether these years nor countries are in adjacent columns/rows in the DataFrame. With <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>, we can use lists, rather than ranges separated by <code class="docutils literal notranslate"><span class="pre">:</span></code>, as selectors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;Finland&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span> <span class="s1">&#39;Sweden&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;gdpPercap_1992&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_2002&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>We can equivalently write the command over several lines to make it a bit easier to read:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;Finland&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span> <span class="s1">&#39;Sweden&#39;</span><span class="p">],</span> 
       <span class="p">[</span><span class="s1">&#39;gdpPercap_1992&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_2002&#39;</span><span class="p">]</span>
      <span class="p">]</span>
</pre></div>
</div>
<p>We could also define those lists as variables, and pass the variables to <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>. This might be useful if you were going to use the lists more than once, as well as for clarity:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scand_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;Finland&#39;</span><span class="p">,</span> <span class="s1">&#39;Iceland&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span> <span class="s1">&#39;Sweden&#39;</span><span class="p">]</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gdpPercap_1992&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_2002&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scand_countries</span><span class="p">,</span> <span class="n">years</span><span class="p">]</span>
</pre></div>
</div>
<p>We can take this a step further, and assign the output of a <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> selection like this to a new variable name. This makes a copy of the selected data, stored in a new DataFrame (or Series, if we only select one row or column) with its own name. This allows us to later reference and use that selection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scand_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scand_countries</span><span class="p">,</span> <span class="n">years</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="it-s-easy-to-do-simple-math-and-statistics-in-dataframes">
<h2>It’s easy to do simple math and statistics in DataFrames<a class="headerlink" href="#it-s-easy-to-do-simple-math-and-statistics-in-dataframes" title="Permalink to this headline">¶</a></h2>
<p>We prevoiusly learned about methods to get simple statistical values out of a Python list, like <code class="docutils literal notranslate"><span class="pre">.max()</span></code>, and <code class="docutils literal notranslate"><span class="pre">.min()</span></code>. pandas includes these and many more methods as well. For example, we can view the mean GDP for Italy across all years (columns) with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Italy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<p>Or the largest GDP in 1977 with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;gdpPercap_1977&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<p>Another useful method is <code class="docutils literal notranslate"><span class="pre">.describe()</span></code>, which prints out a range of descriptive statistics for the range of data you specify. Without any slicing it provides information for each column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="mini-exercise">
<h3>Mini-Exercise<a class="headerlink" href="#mini-exercise" title="Permalink to this headline">¶</a></h3>
<p>In the cell below, use the <code class="docutils literal notranslate"><span class="pre">scand_countries</span></code> and <code class="docutils literal notranslate"><span class="pre">years</span></code> variables to view descriptive statistics for all Scandinavian countries in each year.</p>
</div>
</div>
<div class="section" id="evaluate-cells-based-on-conditions">
<h2>Evaluate cells based on conditions<a class="headerlink" href="#evaluate-cells-based-on-conditions" title="Permalink to this headline">¶</a></h2>
<p>pandas allows an easy way to identify values in a DataFrame that meet a certain condition, using operators like <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">==</span></code>. For example, let’s see which countries in a list had a GDP over 10,000 in 1962 and 1992. The result is reported in Booleans (True/False) for each cell.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;France&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">countries</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;gdpPercap_1962&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_1992&#39;</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">10000</span>
</pre></div>
</div>
</div>
<div class="section" id="select-values-or-nan-using-a-boolean-mask">
<h2>Select values or NaN using a Boolean mask.<a class="headerlink" href="#select-values-or-nan-using-a-boolean-mask" title="Permalink to this headline">¶</a></h2>
<p>A DataFrame full of Booleans is sometimes called a <em>mask</em> because of how it can be used. A mask removes values that are not True, and replaces them with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> — a special Python value representing “not a number”. This can be useful because pandas ignores NaN values when doing computations.</p>
<p>We create a mask by assigning the output of a conditional statement to a variable name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">scand_data</span> <span class="o">&gt;</span> <span class="mi">30000</span>
</pre></div>
</div>
<p>Then we can apply the mask to the DataFrame to get only the values that meet the criterion:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scand_data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
<p>As an example of how this might be used, the steps above would now allow us to find the lowest GDP value in each year, that was above 30,000:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scand_data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="split-apply-combine">
<h2>Split-Apply-Combine<a class="headerlink" href="#split-apply-combine" title="Permalink to this headline">¶</a></h2>
<p>A common task in data science is to split data into meaningful subgroups, apply an operation to each subgroup (e.g., compute the mean), and then combine the results into a single output, such as a table or a new DataFrame. This paradigm was famously <a class="reference external" href="http://dx.doi.org/10.18637/jss.v040.i01">described by Hadley Wickham in a 2011 paper</a>.</p>
<p>pandas provides methods and grouping operations that are very efficient (<em>vectorized</em>) for split-apply-combine operations.</p>
<p>As an example, let’s say that we wanted to compare the average GDP for different regions of Europe, divided as northern, southern, eastern, and western. To do this, we first have to create lists defining the countries belonging to each of these regions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">northern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Denmark&#39;</span><span class="p">,</span> <span class="s1">&#39;Finland&#39;</span><span class="p">,</span> <span class="s1">&#39;Iceland&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">,</span> <span class="s1">&#39;Sweden&#39;</span><span class="p">]</span>
<span class="n">southern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Greece&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Portugal&#39;</span><span class="p">,</span> <span class="s1">&#39;Spain&#39;</span><span class="p">]</span>
<span class="n">eastern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Albania&#39;</span><span class="p">,</span> <span class="s1">&#39;Bosnia and Herzegovina&#39;</span><span class="p">,</span> <span class="s1">&#39;Bulgaria&#39;</span><span class="p">,</span> <span class="s1">&#39;Croatia&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Czech Republic&#39;</span><span class="p">,</span> <span class="s1">&#39;Hungary&#39;</span><span class="p">,</span> <span class="s1">&#39;Montenegro&#39;</span><span class="p">,</span> <span class="s1">&#39;Poland&#39;</span><span class="p">,</span> <span class="s1">&#39;Romania&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Serbia&#39;</span><span class="p">,</span> <span class="s1">&#39;Slovak Republic&#39;</span><span class="p">,</span> <span class="s1">&#39;Slovenia&#39;</span><span class="p">]</span>
<span class="n">western</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Austria&#39;</span><span class="p">,</span>  <span class="s1">&#39;Belgium&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span> <span class="s1">&#39;Ireland&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Netherlands&#39;</span><span class="p">,</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">,</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Next we can make a new column simply by using <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> with the rows specified by one of the lists we just defined, a column name that doesn’t already exist (in this case, we’ll call it “region”), then assigning a region label to that combination of rows and column. We need to do this separately for each region. Note that when we first create the new column (“region”), pandas fills it with NaN values in any rows that were not defined by the assignment. For example, in the code below, the first line will create the column “region”, and fill it with “northern” for any row in the <code class="docutils literal notranslate"><span class="pre">northern</span></code> list, and <code class="docutils literal notranslate"><span class="pre">NaN</span></code> to every other row.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">northern</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;northern&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">southern</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;southern&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">eastern</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;eastern&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">western</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;western&#39;</span>
</pre></div>
</div>
<div class="section" id="split">
<h3>Split<a class="headerlink" href="#split" title="Permalink to this headline">¶</a></h3>
<p>Now we can use this “region” column to split the data into groups, using a pandas method called <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_countries</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;region&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this step doesn’t create a new DataFrame, it creates a special kind of pandas object that points to a grouping in the original DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">grouped_countries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="apply">
<h3>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h3>
<p>Now that we have split the data, we can apply a function separately to each group. Here we’ll compute the mean GDP for each region, for each year:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean_gdp_by_region</span> <span class="o">=</span> <span class="n">grouped_countries</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="combine">
<h3>Combine<a class="headerlink" href="#combine" title="Permalink to this headline">¶</a></h3>
<p>The combine step actually occurred with the <em>apply</em> step above — the result is automatically combined into a table of mean values organized by region. But since our <em>apply</em> step (<code class="docutils literal notranslate"><span class="pre">.mean()</span></code>) saved the result to a variable, we can view the resulting table as the output of the <em>combine</em> step:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean_gdp_by_region</span>
</pre></div>
</div>
</div>
<div class="section" id="chaining">
<h3>Chaining<a class="headerlink" href="#chaining" title="Permalink to this headline">¶</a></h3>
<p>In Python, <strong>chaining</strong> refers to combining a number of operations in one command, using a sequence of methods. We can perform the above split-apply-combine procedure in a single step as follows. Note that because we don’t assign the output to a variable name, it is displayed as output but not saved.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="exercises">
<h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="selecting-individual-values">
<h2>Selecting Individual Values<a class="headerlink" href="#selecting-individual-values" title="Permalink to this headline">¶</a></h2>
<p>Write an expression to find the Per Capita GDP of Serbia in 2007.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN SOLUTION</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Serbia&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_2007&#39;</span><span class="p">])</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">x0</span><span class="o">/</span><span class="n">pvpjfdzd39sc5rqvsk5lvv4m0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_48948</span><span class="o">/</span><span class="mf">973771760.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">### BEGIN SOLUTION</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Serbia&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_2007&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1">### END SOLUTION</span>

<span class="ne">NameError</span>: name &#39;df&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extent-of-slicing">
<h2>Extent of Slicing<a class="headerlink" href="#extent-of-slicing" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Do the two statements below produce the same output? (Hint: you might want to use the <code class="docutils literal notranslate"><span class="pre">.head()</span></code> method to remind yourself of the structure of the DataFrame)</p></li>
<li><p>Based on this, what rule governs what is included (or not) in numerical slices and named slices in Pandas?</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Albania&#39;</span><span class="p">:</span><span class="s1">&#39;Belgium&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap_1952&#39;</span><span class="p">:</span><span class="s1">&#39;gdpPercap_1962&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="answer">
<h3>Answer<a class="headerlink" href="#answer" title="Permalink to this headline">¶</a></h3>
<p>No, they do not produce the same output! The output of the first statement is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">gdpPercap_1952</span>  <span class="n">gdpPercap_1957</span>
<span class="n">country</span>                                
<span class="n">Albania</span>     <span class="mf">1601.056136</span>     <span class="mf">1942.284244</span>
<span class="n">Austria</span>     <span class="mf">6137.076492</span>     <span class="mf">8842.598030</span>
</pre></div>
</div>
<p>The second statement gives:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">gdpPercap_1952</span>  <span class="n">gdpPercap_1957</span>  <span class="n">gdpPercap_1962</span>
<span class="n">country</span>                                                
<span class="n">Albania</span>     <span class="mf">1601.056136</span>     <span class="mf">1942.284244</span>     <span class="mf">2312.888958</span>
<span class="n">Austria</span>     <span class="mf">6137.076492</span>     <span class="mf">8842.598030</span>    <span class="mf">10750.721110</span>
<span class="n">Belgium</span>     <span class="mf">8343.105127</span>     <span class="mf">9714.960623</span>    <span class="mf">10991.206760</span>
</pre></div>
</div>
<p>Clearly, the second statement produces an additional column and an additional row compared to the first statement.  What conclusion can we draw? We see that a numerical slice, 0:2, <em>omits</em> the final index (i.e. index 2) in the range provided, while a named slice, <code class="docutils literal notranslate"><span class="pre">'gdpPercap_1952':'gdpPercap_1962'</span></code>, <em>includes</em> the final element.</p>
</div>
</div>
<div class="section" id="reconstructing-data">
<h2>Reconstructing Data<a class="headerlink" href="#reconstructing-data" title="Permalink to this headline">¶</a></h2>
<p>Explain what each line in the following short program does:
what is in <code class="docutils literal notranslate"><span class="pre">first</span></code>, <code class="docutils literal notranslate"><span class="pre">second</span></code>, etc.?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/gapminder_all.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Americas&#39;</span><span class="p">]</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Puerto Rico&#39;</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;continent&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;result.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h2>
<p>Let’s go through this piece of code line by line.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/gapminder_all.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This line loads the dataset containing the GDP data from all countries into a dataframe called
<code class="docutils literal notranslate"><span class="pre">df1</span></code>. The <code class="docutils literal notranslate"><span class="pre">index_col='country'</span></code> parameter selects which column to use as the
row labels in the dataframe.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Americas&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>This line makes a selection: only those rows of <code class="docutils literal notranslate"><span class="pre">df1</span></code> for which the ‘continent’ column matches ‘Americas’ are extracted. Notice how the Boolean expression inside the brackets, <code class="docutils literal notranslate"><span class="pre">df1['continent']</span> <span class="pre">==</span> <span class="pre">'Americas'</span></code>, is used to select only those rows where the expression is true. Try printing this expression! Can you print also its individual True/False elements? (hint: first assign the expression to a variable)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Puerto Rico&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>As the syntax suggests, this line drops the row from <code class="docutils literal notranslate"><span class="pre">df2</span></code> where the label is ‘Puerto Rico’. The resulting dataframe <code class="docutils literal notranslate"><span class="pre">df3</span></code> has one row less than the original dataframe <code class="docutils literal notranslate"><span class="pre">df2</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;continent&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Again we apply the drop function, but in this case we are dropping not a row but a whole column. To accomplish this, we need to specify also the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter (we want to drop the second column which has index 1).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;result.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The final step is to write the data that we have been working on to a csv file. Pandas makes this easy with the <code class="docutils literal notranslate"><span class="pre">to_csv()</span></code> function. The only required argument to the function is the filename. Note that the file will be written in the directory from which you started the Jupyter or Python session.</p>
</div>
<div class="section" id="selecting-indices">
<h2>Selecting Indices<a class="headerlink" href="#selecting-indices" title="Permalink to this headline">¶</a></h2>
<p>Explain in simple terms what <code class="docutils literal notranslate"><span class="pre">idxmin</span></code> and <code class="docutils literal notranslate"><span class="pre">idxmax</span></code> do. When would you use these methods?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/gapminder_gdp_europe.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>Solution<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>For each column in <code class="docutils literal notranslate"><span class="pre">data</span></code>, <code class="docutils literal notranslate"><span class="pre">idxmin</span></code> will return the index value corresponding to each column’s minimum;
<code class="docutils literal notranslate"><span class="pre">idxmax</span></code> will do accordingly the same for each column’s maximum value.</p>
<p>You can use these functions whenever you want to get the row index of the minimum/maximum value and not the actual minimum/maximum value.</p>
</div>
<div class="section" id="practice-with-selection">
<h2>Practice with Selection<a class="headerlink" href="#practice-with-selection" title="Permalink to this headline">¶</a></h2>
<p>From the previous exercise, the Gapminder GDP data for Europe should be loaded in as <code class="docutils literal notranslate"><span class="pre">data</span></code>. Using this DataFrame, write an expression to select each of the following:</p>
<ul class="simple">
<li><p>GDP per capita for all countries in 1982</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN SOLUTION</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;gdpPercap_1982&#39;</span><span class="p">]</span>

<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>GDP per capita for Denmark for all years</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN SOLUTION</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Denmark&#39;</span><span class="p">,:]</span>

<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>GDP per capita for all countries for years <em>after</em> 1985</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN SOLUTION</span>

<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;gdpPercap_1985&#39;</span><span class="p">:]</span>

<span class="c1"># Pandas is smart enough to recognize the number at the end of the column label </span>
<span class="c1"># and does not give you an error, although no column named `gdpPercap_1985` actually </span>
<span class="c1"># exists. This is useful if new columns are added to the CSV file later.</span>

<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>GDP per capita for each country in 2007 as a multiple of GDP per capita for that country in 1952</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN SOLUTION</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;gdpPercap_2007&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gdpPercap_1952&#39;</span><span class="p">]</span>

<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-the-dir-function-to-see-available-methods">
<h2>Using the <code class="docutils literal notranslate"><span class="pre">dir</span></code> function to see available methods<a class="headerlink" href="#using-the-dir-function-to-see-available-methods" title="Permalink to this headline">¶</a></h2>
<p>Python includes a <code class="docutils literal notranslate"><span class="pre">dir</span></code> function that can be used to display all of the available methods (functions) that are built into a data object.  As an example, the  functions available for a <a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#more-on-lists">list data type</a> are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">potatoes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Russet&quot;</span><span class="p">,</span> <span class="s2">&quot;Norkota&quot;</span><span class="p">,</span> <span class="s2">&quot;Yukon Gold&quot;</span><span class="p">,</span> <span class="s2">&quot;Pontiac&quot;</span><span class="p">]</span>
<span class="nb">dir</span><span class="p">(</span><span class="n">potatoes</span><span class="p">)</span>
</pre></div>
</div>
<p>This command returns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;__add__&#39;</span><span class="p">,</span>
<span class="o">...</span>
<span class="s1">&#39;__subclasshook__&#39;</span><span class="p">,</span>
 <span class="s1">&#39;append&#39;</span><span class="p">,</span>
 <span class="s1">&#39;clear&#39;</span><span class="p">,</span>
 <span class="s1">&#39;copy&#39;</span><span class="p">,</span>
 <span class="s1">&#39;count&#39;</span><span class="p">,</span>
<span class="s1">&#39;extend&#39;</span><span class="p">,</span>
<span class="s1">&#39;index&#39;</span><span class="p">,</span>
<span class="s1">&#39;insert&#39;</span><span class="p">,</span>
<span class="s1">&#39;pop&#39;</span><span class="p">,</span>
<span class="s1">&#39;remove&#39;</span><span class="p">,</span>
<span class="s1">&#39;reverse&#39;</span><span class="p">,</span>
<span class="s1">&#39;sort&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The double underscore functions can be ignored for now; functions that are not surrounded by double underscores are the <em>public interface</em> of the <a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#more-on-lists">list type</a>. So, if you want to sort the list of potatoes, according to <code class="docutils literal notranslate"><span class="pre">dir</span></code> you should try,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">potatoes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
<p>Assume pandas has been imported and the Gapminder GDP data for Europe has been loaded as <code class="docutils literal notranslate"><span class="pre">data</span></code>.  Then, use <code class="docutils literal notranslate"><span class="pre">dir</span></code> to find the function that prints out the median per-capita GDP across all European countries for each year that information is available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### BEGIN SOLUTION</span>
<span class="n">data</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interpretation">
<h2>Interpretation<a class="headerlink" href="#interpretation" title="Permalink to this headline">¶</a></h2>
<p>Poland’s borders have been stable since 1945, but changed several times in the years before then. How would you handle this if you were creating a table of GDP per capita for Poland for the entire twentieth century?</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary-of-key-points">
<h1>Summary of Key Points:<a class="headerlink" href="#summary-of-key-points" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">DataFrame.iloc[]</span></code> to select values by integer location, using [row, column] format</p></li>
<li><p>Select multiple columns or rows using <code class="docutils literal notranslate"><span class="pre">DataFrame.loc</span></code> and a named slice.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">:</span></code> on its own to mean all columns or all rows.</p></li>
<li><p>Result of slicing can be used in further operations.</p></li>
<li><p>Use comparisons to select data based on value.</p></li>
<li><p>Select values or NaN using a Boolean mask.</p></li>
<li><p>use split-apply-combine to derive analytics from groupings within a DataFrame</p></li>
</ul>
<hr class="docutils" />
<p>This lesson is adapted from the <a class="reference external" href="https://software-carpentry.org/lessons/">Software Carpentry</a> <a class="reference external" href="http://swcarpentry.github.io/python-novice-gapminder/">Plotting and Programming in Python</a> workshop.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="conditionals.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Conditionals</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="looping-data-files.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Looping Over Data Files</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Aaron J Newman<br/>
        
            &copy; Copyright 2020-21. This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Unported License.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-171426664-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>