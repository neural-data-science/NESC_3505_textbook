
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ERP Preprocessing and Derivation Using MNE &#8212; Data Science for Psychology and Neuroscience — in Python</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="http://neuraldatascience.io/eeg/_extra/EEG_data_analysis_template.html" />
    <link rel="shortcut icon" href="../../_static/NESC3505_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-171426664-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/NESC3505_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Science for Psychology and Neuroscience — in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About This Course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/why.html">
   Start with why
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/learning_objectives.html">
   Learning Objectives for this Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus.html">
   Syllabus
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pedagogy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/teaching_approach.html">
   Teaching Approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/online_learning.html">
   Hybrid Online Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/assessment_evaluation.html">
   Assessment and Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/constructivism.html">
   Constructivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/connectivism.html">
   Connectivism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/authenticity.html">
   Authenticity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/21st_cen_skills.html">
   21st Century Skills
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Open Software, Science, &amp; Education
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/open.html">
   Open Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/software.html">
   Free Software
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/free_licenses.html">
   Free and Open-Source Software Licenses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/open_science.html">
   Open Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/peer_review.html">
   Peer Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/for_profit.html">
   For-Profit Publishing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/impact_factors.html">
   Impact Factors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/novelty.html">
   Novelty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/open_publishing.html">
   Open Publishing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/preregistration.html">
   Preregistration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/open_methods.html">
   Open Methods and Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/oer.html">
   Open Educational Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/oer_this_course.html">
   OERs in the Context of this Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/licenses.html">
   Licenses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  How to Rock This Course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/learning_approach.html">
   Learning Approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/mindset.html">
   Mindset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/errors_debugging.html">
   Errors and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1/teamwork.html">
   Collaboration and Teamwork
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../2/introduction.html">
   Getting Started with the Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../2/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../2/what_is_nds.html">
   What is Data Science?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/data.html">
     Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../2/tools_for_nds.html">
   Tools for Neural Data Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/spreadsheets.html">
     Spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/spreadsheets_limits.html">
     Limitations of Spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/reproducibility.html">
     Reproducibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/sci_prog_lang.html">
     Scientific Programming Languages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/which_lang.html">
     Which language to use?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/libs.html">
     Libraries and packages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/why_python.html">
     Why Python for this Course?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../2/class_tech.html">
   Technologies Used in this Class
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/lms.html">
     Learning Management System
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/teams.html">
     MS Teams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/communication.html">
     Communication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/videos.html">
     Course Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../2/coding.html">
   Coding Tools
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/python.html">
     Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/datacamp.html">
     DataCamp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/py4e.html">
     Python for Everybody (PY4E)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/terminal.html">
     The Terminal and Command Line
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/jupyter.html">
     Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/markdown.html">
     Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/cocalc.html">
     CoCalc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../2/github.html">
     GitHub
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../2/alltogether.html">
   Putting It All Together
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../2/get_going.html">
   Get Going!
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introducing Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/introduction.html">
   Introducing Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/getting_help.html">
   Getting Help with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/variables-and-assignment.html">
   Variables and Assignment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/types-conversion.html">
   Data Types and Conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/built-in.html">
   Python Built-Ins
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/lists.html">
   Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/dictionaries.html">
   Dictionaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/for-loops.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     for
    </span>
   </code>
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/conditionals.html">
   Conditionals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/pandas-dataframes.html">
   pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3/looping-data-files.html">
   Looping Over Data Files
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Visualizing Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/introduction.html">
   Introduction to Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/plotting.html">
   Introduction to Plotting with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/proc_vs_oo.html">
   Procedural versus Object-Oriented Plotting in Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/subplots.html">
   Subplots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/plotting_types.html">
   Thinking About Data for Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/seaborn.html">
   Introduction to Plotting with Seaborn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../visualization/human_factors.html">
   Accessibility and Human Factors in Plotting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exploratory Data Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../eda/introduction.html">
   Introduction to EDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../eda/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../eda/repeated_measures.html">
   Working with Repeated Measures Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../eda/data_cleaning.html">
   Data Cleaning - Dealing with Outliers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../eda/ttests.html">
   Basic Statistics in Python:
   <em>
    t
   </em>
   tests with SciPy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Single Unit Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/introduction.html">
   Introduction to Single Unit Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/single_unit_intro.html">
   Single Unit Data and Spike Trains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/intro_spike_trains.html">
   Introduction to Spike Train Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/ten_intensities.html">
   Effects of Light Intensity on Spike Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/heat_maps.html">
   Heat Maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/intro_multielec_data.html">
   Introducing Multielectrode Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/pandas_multielec.html">
   Working with Multielectrode Data in pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../single_unit/corr_spike_trains.html">
   Correlating spike trains
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  EEG Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Introduction to EEG/ERP Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../time_freq.html">
   Time and Frequency Domains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../erps.html">
   Event-Related Potentials (ERPs)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../components.html">
   ERP Components
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mne_python.html">
   MNE-Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mne_data.html">
   Exploring MNE’s data structure
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../erp_preprocessing.html">
   EEG-ERP Preprocessing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../erp_filtering.html">
     Filtering EEG Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../erp_artifacts.html">
     Artifacts in EEG Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../erp_segmentation.html">
     Segmentation into ERP epochs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../erp_rereferencing.html">
     Re-referencing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../erp_averaging.html">
     Averaging ERPs: Creating MNE Evoked objects
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MRI Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../mri/introduction.html">
   Introduction to MRI Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mri/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../machine_learning/introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../zrefs.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/eeg/_extra/EEG_data_analysis_template.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/DalPsychNeuro/NESC_3505_textbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/DalPsychNeuro/NESC_3505_textbook/issues/new?title=Issue%20on%20page%20%2Feeg/_extra/EEG_data_analysis_template.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DalPsychNeuro/NESC_3505_textbook/master?urlpath=tree/eeg/_extra/EEG_data_analysis_template.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   ERP Preprocessing and Derivation Using MNE
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-in-the-necessary-libraries-packages-we-ll-need">
     Load in the necessary libraries/packages we’ll need
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-parameters">
     Set Parameters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#subject-name">
       Subject name
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#condition-trigger-codes">
       Condition/Trigger Codes
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#map-each-numerical-trigger-code-that-you-want-to-average-erps-to-to-a-text-label-for-that-condition">
         Map each numerical trigger code that you want to average ERPs to, to a text label for that condition
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#specify-the-between-condition-differences-you-want-to-compute">
         Specify the between-condition differences you want to compute
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#epoch-window">
       Epoch window
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#other-parameters">
       Other parameters
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-data">
     Import data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering">
     Filtering
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-plot-frequency-spectrum-prior-to-filtering-for-later-comparison">
       First plot frequency spectrum prior to filtering, for later comparison
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#now-bandpass-filter-then-plot-filtered-data">
       Now bandpass filter, then plot filtered data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interactive-plot-of-continuous-data-identify-and-mark-bad-channels">
     Interactive plot of continuous data - identify and mark bad channels
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#list-any-bad-channels-that-you-found-in-the-interactive-plot-in-bads">
       List any bad channels that you found in the interactive plot, in ‘bads’:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#event-processing">
   Event Processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-code-positions-over-time">
     Visualize code positions over time
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#epoching">
     Epoching
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#print-of-epochs-in-each-condition">
       Print # of epochs in each condition
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-epochs-and-go-through-manually-marking-bad-trials">
     Plot epochs and go through, manually marking bad trials
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reproducable-science">
       Reproducable science
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-average-of-all-epochs">
       Plot average of all epochs
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-ica-to-identify-and-correct-ocular-artifacts">
   Run ICA to identify and correct ocular artifacts
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-scalp-maps-of-each-independent-component">
     Plot scalp maps of each Independent Component
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-individual-components-and-do-manual-artifact-selection">
     Plot individual components and do manual artifact selection
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manually-specify-ics-to-remove-based-on-visual-inspection">
     Manually specify ICs to remove, based on visual inspection
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-ica-corrections-to-data-and-re-reference-to-average-mastoids">
   Apply ICA corrections to data, and re-reference to average mastoids
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-epochs-again-and-remove-any-that-ica-didn-t-clean-up">
     Check epochs again and remove any that ICA didn’t clean up
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-evoked-responses-averaged-epochs-for-each-condition">
   Create Evoked Responses (averaged epochs for each condition)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-averaged-erp-for-each-condition">
     Plot averaged ERP for each condition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#topoplots-for-each-condition">
     Topoplots for each condition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-each-condition-overlaid-at-one-electrode">
     Plot each condition, overlaid, at one electrode
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-between-condition-differences">
   Compute Between-Condition Differences
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-difference-waves">
     Plot difference waves
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-each-contrast-overlaid-at-one-electrode">
       Plot each contrast, overlaid, at one electrode
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-topomaps-of-differences-at-100-ms-intervals">
       Plot topomaps of differences at 100 ms intervals
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-mean-amplitude-over-time-window-of-interest">
     Plot mean amplitude over time window of interest
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="erp-preprocessing-and-derivation-using-mne">
<h1>ERP Preprocessing and Derivation Using MNE<a class="headerlink" href="#erp-preprocessing-and-derivation-using-mne" title="Permalink to this headline">¶</a></h1>
<p>This notebook reads in a raw, continuous EEG data file with trigger codes, saved in BrainVision <code class="docutils literal notranslate"><span class="pre">.vhdr</span></code> format, and preprocesses it (including filtering, segmentation, artifact detection/ICA correction), and plots means for each experimental condition, along with differences.</p>
<p>Note that for this to run, you need:</p>
<ul class="simple">
<li><p>Anaconda python and MNE installed on your computer (instructions below)</p></li>
<li><p>this Jupyter notebook file</p></li>
<li><p>the 3 raw files that are saved when you run an EEG subject (which end in <code class="docutils literal notranslate"><span class="pre">.vhdr</span></code>, <code class="docutils literal notranslate"><span class="pre">.vmrk</span></code>, and <code class="docutils literal notranslate"><span class="pre">.eeg</span></code>).</p></li>
<li><p><em>Do not rename these files</em> — you will get an error when it tries to load your data, if you renamed the raw EEG files after recording.</p></li>
<li><p>This .ipynb notebook file, and the three raw data files, all need to be in the same directory (folder) in order for this to work.</p></li>
</ul>
<p>For each subject you analyze, you should <em>make a copy of this notebook file</em>, then change the appropriate lines (subject_id, trials/ICA components to remove). You definitely want to keep a record of what was done for each subject and what the results looked like, so don’t just keep re-using the same notebook for each subject!</p>
<div class="section" id="load-in-the-necessary-libraries-packages-we-ll-need">
<h2>Load in the necessary libraries/packages we’ll need<a class="headerlink" href="#load-in-the-necessary-libraries-packages-we-ll-need" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io.reference</span> <span class="kn">import</span> <span class="n">set_eeg_reference</span>
<span class="n">mne</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-parameters">
<h2>Set Parameters<a class="headerlink" href="#set-parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="subject-name">
<h3>Subject name<a class="headerlink" href="#subject-name" title="Permalink to this headline">¶</a></h3>
<p>This should be the name of the input files, without the extensions. So if your EEG files are <code class="docutils literal notranslate"><span class="pre">subj_01.eeg</span></code>, <code class="docutils literal notranslate"><span class="pre">subj_01.vhdr</span></code>, and <code class="docutils literal notranslate"><span class="pre">subj_01.vmrk</span></code>, then you would put <code class="docutils literal notranslate"><span class="pre">subj_01</span></code> here as the subject name. And yes, capitalization/exact spelling matters!</p>
<p>The script assumes that the raw data files are in the same folder as this jupyter notebook script.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;P4&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="condition-trigger-codes">
<h3>Condition/Trigger Codes<a class="headerlink" href="#condition-trigger-codes" title="Permalink to this headline">¶</a></h3>
<p>For this script, we’re using data from a sentence procesing study that basically tried to replicate the original Kutas &amp; Hillyard (1980) N400 experiment, with an additional condition (violation words could be nouns OR adjectives):</p>
<ul class="simple">
<li><p>control words (e.g. last word in the sentence, “I take my coffee with milk and <em>sugar</em>.”</p></li>
<li><p>noun violations (“I take my coffee with milk and <em>dog</em>.”</p></li>
<li><p>adjective violations (“I take my coffee with milk and <em>slippery</em>.”)</p></li>
</ul>
<p>That should help you understand how the analysis shown here works. Additionally, to show how you might adapt this, let’s say you had a face processing experiment. You used <code class="docutils literal notranslate"><span class="pre">1</span></code> as the code for fixation crosses between each stimulus (which you ultimately don’t care about), <code class="docutils literal notranslate"><span class="pre">2</span></code> as the code for upright faces, and <code class="docutils literal notranslate"><span class="pre">3</span></code> as the code for inverted faces.</p>
<p><code class="docutils literal notranslate"><span class="pre">event_id</span></code> serves to match your numerical event trigger codes (sent form the stim program to the EEG system) with meaningful text labels.  So for our example, you would change this line to:
<code class="docutils literal notranslate"><span class="pre">event_id</span> <span class="pre">=</span> <span class="pre">{'fixation':1,</span> <span class="pre">'upright':2,</span> <span class="pre">'inverted':3}</span></code></p>
<p>Finally, we can code for the contrasts (comparisons between conditions) that we are interested in — the things we’d like to create difference waves for. In this case, that would be the inverted-upright difference. We use <code class="docutils literal notranslate"><span class="pre">expt_contrasts</span></code> to give the contrast a meaningful text label (whatever you like):
<code class="docutils literal notranslate"><span class="pre">expt_contrasts</span> <span class="pre">=</span> <span class="pre">('inv-up')</span></code></p>
<p>…and then we use <code class="docutils literal notranslate"><span class="pre">expt_contrast_conds</span></code> to specify the things in cond_of_interest that we want to compare. The script below will subtract the second thing you list in <code class="docutils literal notranslate"><span class="pre">expt_contrast_conds</span></code> from the first thing you list, so in our example we’d use:
<code class="docutils literal notranslate"><span class="pre">expt_contrast_conds</span> <span class="pre">=</span> <span class="pre">[[cond_of_interest.index('inverted'),</span> <span class="pre">cond_of_interest.index('upright')]]</span></code></p>
<p>Note that the contrast consists of two condition listings, separated by a comma, and inside square brackets. There’s a second set of square brackets that surrounds the whole list of different contrasts you’ll do. See the code in the cell below for an example with 3 contrasts.</p>
<p>Note that the template file I’m providing lists 3 event types and more contrasts, which should help you figure things out and get the formatting right if you have more than just two conditions of interest and one contrast.</p>
<div class="section" id="map-each-numerical-trigger-code-that-you-want-to-average-erps-to-to-a-text-label-for-that-condition">
<h4>Map each numerical trigger code that you want to average ERPs to, to a text label for that condition<a class="headerlink" href="#map-each-numerical-trigger-code-that-you-want-to-average-erps-to-to-a-text-label-for-that-condition" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Control&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;NounViol&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;AdjectiveViol&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>

<span class="n">cond_of_interest</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">event_id</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="specify-the-between-condition-differences-you-want-to-compute">
<h4>Specify the between-condition differences you want to compute<a class="headerlink" href="#specify-the-between-condition-differences-you-want-to-compute" title="Permalink to this headline">¶</a></h4>
<p>Formally, you are creating a Python ‘dictionary’ where the keys (before the colon) are the labels for each contrast, and the values (in square brackets, after the colon) are a list of the two conditons you want to create. The second item in the list is subtracted from the first.</p>
<p>Practically, this means that each contrast is represented as a label, followed by a colon, followed by the names of the two conditions you want to compare. Those two names should be enclosed in square brackets with a comma between them. The names of the conditions need to be the ones you assigned to the codes in <code class="docutils literal notranslate"><span class="pre">event_id</span></code>, above</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expt_contrasts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Noun-Ctrl&#39;</span><span class="p">:[</span><span class="s1">&#39;NounViol&#39;</span><span class="p">,</span><span class="s1">&#39;Control&#39;</span><span class="p">],</span> 
                  <span class="s1">&#39;Adj-Ctrl&#39;</span><span class="p">:[</span><span class="s1">&#39;AdjectiveViol&#39;</span><span class="p">,</span> <span class="s1">&#39;Control&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;Noun-Adj&#39;</span><span class="p">:[</span><span class="s1">&#39;NounViol&#39;</span><span class="p">,</span> <span class="s1">&#39;AdjectiveViol&#39;</span><span class="p">]</span>
                 <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="epoch-window">
<h3>Epoch window<a class="headerlink" href="#epoch-window" title="Permalink to this headline">¶</a></h3>
<p>Specify the time for the start of the epoch (the baseline period, so it should be a negative number indicating how long before the code onset you want as a baseline), and the end (which is the time <em>after</em> the onset of the code that you want). So your total epoch length will be the sum of the baseline and tmax.</p>
<p>In general, -0.2 for the baseline and 1.0 for the post-stimulus period will work fine, but in some cases you might want to change these (e.g., if your stimuli occurred less than 1 s from each other).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start of each epoch (in sec):</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>  

<span class="c1"># End of each epoch (in sec)</span>
<span class="n">tmax</span> <span class="o">=</span>  <span class="mf">1.0</span>  
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="other-parameters">
<h3>Other parameters<a class="headerlink" href="#other-parameters" title="Permalink to this headline">¶</a></h3>
<p>You shouldn’t need to change anything down here</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;./&#39; specifies that data are in the same directory as this notebook</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;data/&#39;</span> 

<span class="c1"># Input should be continuous EEG data in EEGLAB format, named as [subject].set</span>
<span class="n">raw_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;.vhdr&#39;</span>

<span class="c1"># Filter cutoffs and other parameters</span>
<span class="n">l_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">h_freq</span> <span class="o">=</span> <span class="mf">40.0</span>
<span class="n">l_trans_bandwidth</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
<span class="n">h_trans_bandwidth</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
<span class="n">filter_length</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>

<span class="c1"># maximum number of ICs to reject in ICA artifact correction</span>
<span class="n">ica_random_state</span> <span class="o">=</span> <span class="mi">42</span>  <span class="c1"># seed so ICA is reproducable each time it&#39;s run</span>

<span class="c1">#################################################################</span>
<span class="c1"># It&#39;s unlikely you will want to change any settings below here</span>

<span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># means from the first instant to t = 0</span>
<span class="n">reject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">200e-6</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">200e-6</span><span class="p">)</span>  <span class="c1"># EEG data are in V, so e-6 gives microVolts</span>

<span class="c1"># standard montage file to look up channel locations</span>
<span class="n">montage_fname</span> <span class="o">=</span> <span class="s1">&#39;standard_1005&#39;</span>

<span class="c1"># output file names - set to follow MNE conventions</span>
<span class="n">events_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;-eve.fif&#39;</span>
<span class="n">epochs_fname</span>  <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;-epo.fif&#39;</span>
<span class="n">evoked_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s1">&#39;-ave.fif&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="import-data">
<h2>Import data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_brainvision</span><span class="p">(</span><span class="n">raw_fname</span><span class="p">,</span> 
                                  <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">30757916.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_brainvision</span><span class="p">(</span><span class="n">raw_fname</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                   <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/mne/io/brainvision/brainvision.py</span> in <span class="ni">read_raw_brainvision</span><span class="nt">(vhdr_fname, eog, misc, scale, preload, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">855</span>     <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">Raw</span> <span class="p">:</span> <span class="n">Documentation</span> <span class="n">of</span> <span class="n">attribute</span> <span class="ow">and</span> <span class="n">methods</span><span class="o">.</span>
<span class="g g-Whitespace">    </span><span class="mi">856</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">857</span><span class="sd">     return RawBrainVision(vhdr_fname=vhdr_fname, eog=eog,</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span><span class="sd">                           misc=misc, scale=scale, preload=preload,</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span><span class="sd">                           verbose=verbose)</span>

<span class="nn">&lt;decorator-gen-211&gt;</span> in <span class="ni">__init__</span><span class="nt">(self, vhdr_fname, eog, misc, scale, preload, verbose)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/mne/io/brainvision/brainvision.py</span> in <span class="ni">__init__</span><span class="nt">(self, vhdr_fname, eog, misc, scale, preload, verbose)</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span><span class="sd">         vhdr_fname = op.abspath(vhdr_fname)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span><span class="sd">         (info, data_fname, fmt, order, n_samples, mrk_fname, montage,</span>
<span class="ne">---&gt; </span><span class="mi">73</span><span class="sd">          orig_units) = _get_vhdr_info(vhdr_fname, eog, misc, scale)</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">75</span><span class="sd">         with open(data_fname, &#39;rb&#39;) as f:</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/mne/io/brainvision/brainvision.py</span> in <span class="ni">_get_vhdr_info</span><span class="nt">(vhdr_fname, eog, misc, scale)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span><span class="sd">                       &quot;not a file with extension &#39;%s&#39;.&quot; % ext)</span>
<span class="g g-Whitespace">    </span><span class="mi">456</span><span class="sd"> </span>
<span class="ne">--&gt; </span><span class="mi">457</span><span class="sd">     settings, cfg, cinfostr, info = _aux_vhdr_info(vhdr_fname)</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span><span class="sd">     info._unlocked = True</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span><span class="sd"> </span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/mne/io/brainvision/brainvision.py</span> in <span class="ni">_aux_vhdr_info</span><span class="nt">(vhdr_fname)</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span><span class="sd"> def _aux_vhdr_info(vhdr_fname):</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span><span class="sd">     &quot;&quot;&quot;</span><span class="n">Aux</span> <span class="n">function</span> <span class="k">for</span> <span class="n">_get_vhdr_info</span><span class="o">.</span><span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">359</span><span class="s2">     with open(vhdr_fname, &#39;rb&#39;) as f:</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span><span class="s2">         # extract the first section to resemble a cfg</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span><span class="s2">         header = f.readline()</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/Users/aaron/3505/NESC_3505_textbook/eeg/_extra/data/P4.vhdr&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="filtering">
<h2>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h2>
<div class="section" id="first-plot-frequency-spectrum-prior-to-filtering-for-later-comparison">
<h3>First plot frequency spectrum prior to filtering, for later comparison<a class="headerlink" href="#first-plot-frequency-spectrum-prior-to-filtering-for-later-comparison" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">raw</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">411546367.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">raw</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>

<span class="ne">NameError</span>: name &#39;raw&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="now-bandpass-filter-then-plot-filtered-data">
<h3>Now bandpass filter, then plot filtered data<a class="headerlink" href="#now-bandpass-filter-then-plot-filtered-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filt_eeg</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="p">,</span> <span class="n">h_freq</span><span class="p">,</span> 
                             <span class="n">l_trans_bandwidth</span> <span class="o">=</span> <span class="n">l_trans_bandwidth</span><span class="p">,</span> 
                             <span class="n">h_trans_bandwidth</span> <span class="o">=</span> <span class="n">h_trans_bandwidth</span><span class="p">,</span> 
                             <span class="n">filter_length</span><span class="o">=</span><span class="n">filter_length</span><span class="p">,</span> 
                             <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fft&#39;</span><span class="p">,</span> 
                             <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>  

<span class="n">filt_eeg</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">2086121600.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">filt_eeg</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="p">,</span> <span class="n">h_freq</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                              <span class="n">l_trans_bandwidth</span> <span class="o">=</span> <span class="n">l_trans_bandwidth</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                              <span class="n">h_trans_bandwidth</span> <span class="o">=</span> <span class="n">h_trans_bandwidth</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                              <span class="n">filter_length</span><span class="o">=</span><span class="n">filter_length</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                              <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fft&#39;</span><span class="p">,</span>

<span class="ne">NameError</span>: name &#39;raw&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-plot-of-continuous-data-identify-and-mark-bad-channels">
<h2>Interactive plot of continuous data - identify and mark bad channels<a class="headerlink" href="#interactive-plot-of-continuous-data-identify-and-mark-bad-channels" title="Permalink to this headline">¶</a></h2>
<p>Scroll through the plot to identify channels for exclusion from analysis</p>
<p>Sometimes theinteractive plots fail to draw properly - and you’ll just see a balck window, or it will draw but not be interactive. Just re-run the cell and it should work (eventually - mmay take a few tries). Also, you can rezise the plot with the grey triangle in the bottom right corner. This will flicker a lot and take some time to adjust. Be patient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> qt5 
<span class="n">filt_eeg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> 
             <span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">.0001</span><span class="p">),</span> 
             <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Raw EEG&#39;</span><span class="p">);</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">2104183796.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;qt5&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">filt_eeg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span>              <span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">.0001</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>              <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Raw EEG&#39;</span><span class="p">);</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2349</span>                 <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2350</span>             <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2351</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2352</span>             <span class="k">return</span> <span class="n">result</span>
<span class="g g-Whitespace">   </span><span class="mi">2353</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/decorator.py</span> in <span class="ni">fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>                 <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">232</span>             <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>     <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>     <span class="n">fun</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/magic.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(f, *a, **k)</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>     <span class="c1"># but it&#39;s overkill for just that one bit of state.</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="k">def</span> <span class="nf">magic_deco</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">187</span>         <span class="n">call</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> 
<span class="g g-Whitespace">    </span><span class="mi">189</span>         <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/magics/pylab.py</span> in <span class="ni">matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>             <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>             <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3531</span>                 <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3532</span> 
<span class="ne">-&gt; </span><span class="mi">3533</span>         <span class="n">pt</span><span class="o">.</span><span class="n">activate_matplotlib</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3534</span>         <span class="n">configure_inline_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3535</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/pylabtools.py</span> in <span class="ni">activate_matplotlib</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>     <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> 
<span class="ne">--&gt; </span><span class="mi">359</span>     <span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> 
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="n">_needmain</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">switch_backend</span><span class="nt">(newbackend)</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="n">backend_name</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_backend_module_name</span><span class="p">(</span><span class="n">newbackend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> 
<span class="ne">--&gt; </span><span class="mi">277</span>     <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>         <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">backend_mod</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> 
<span class="g g-Whitespace">    </span><span class="mi">277</span>     <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">278</span>         <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> 
<span class="g g-Whitespace">    </span><span class="mi">280</span>     <span class="n">required_framework</span> <span class="o">=</span> <span class="n">_get_required_interactive_framework</span><span class="p">(</span><span class="n">backend_mod</span><span class="p">)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/__init__.py</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                 <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>             <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">127</span>     <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> 
<span class="g g-Whitespace">    </span><span class="mi">129</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap_external.py</span> in <span class="ni">exec_module</span><span class="nt">(self, module)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">backend_qt5agg</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cbook</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">.backend_agg</span> <span class="kn">import</span> <span class="n">FigureCanvasAgg</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">.backend_qt5</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">_BackendQT5</span><span class="p">,</span> <span class="n">FigureCanvasQT</span><span class="p">,</span> <span class="n">FigureManagerQT</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">NavigationToolbar2QT</span><span class="p">,</span> <span class="n">backend_version</span><span class="p">)</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">backend_qt5</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">_Backend</span><span class="p">,</span> <span class="n">FigureCanvasBase</span><span class="p">,</span> <span class="n">FigureManagerBase</span><span class="p">,</span> <span class="n">NavigationToolbar2</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">TimerBase</span><span class="p">,</span> <span class="n">cursors</span><span class="p">,</span> <span class="n">ToolContainerBase</span><span class="p">,</span> <span class="n">StatusbarBase</span><span class="p">,</span> <span class="n">MouseButton</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="kn">import</span> <span class="nn">matplotlib.backends.qt_editor.figureoptions</span> <span class="k">as</span> <span class="nn">figureoptions</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_editor._formsubplottool</span> <span class="kn">import</span> <span class="n">UiSubplotTool</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">qt_compat</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">qt_editor</span><span class="o">/</span><span class="n">figureoptions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">mcolors</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">image</span> <span class="k">as</span> <span class="n">mimage</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_compat</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_editor</span> <span class="kn">import</span> <span class="n">_formlayout</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> 

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">qt_compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>         <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">179</span>         <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Failed to import any qt binding&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span> <span class="k">else</span><span class="p">:</span>  <span class="c1"># We should not get there.</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>     <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Unexpected QT_API: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">QT_API</span><span class="p">))</span>

<span class="ne">ImportError</span>: Failed to import any qt binding
</pre></div>
</div>
</div>
</div>
<div class="section" id="list-any-bad-channels-that-you-found-in-the-interactive-plot-in-bads">
<h3>List any bad channels that you found in the interactive plot, in ‘bads’:<a class="headerlink" href="#list-any-bad-channels-that-you-found-in-the-interactive-plot-in-bads" title="Permalink to this headline">¶</a></h3>
<p>e.g., <code class="docutils literal notranslate"><span class="pre">raw.info['bads']</span> <span class="pre">=</span> <span class="pre">['Oz']</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filt_eeg</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">3047463149.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">filt_eeg</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="ne">NameError</span>: name &#39;filt_eeg&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="event-processing">
<h1>Event Processing<a class="headerlink" href="#event-processing" title="Permalink to this headline">¶</a></h1>
<p>Event codes are stored in a ‘channel’ called STI 014</p>
<div class="section" id="visualize-code-positions-over-time">
<h2>Visualize code positions over time<a class="headerlink" href="#visualize-code-positions-over-time" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fig</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_events</span><span class="p">(</span><span class="n">filt_eeg</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span> <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">2010449658.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_events</span><span class="p">(</span><span class="n">filt_eeg</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span> <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">);</span>

<span class="ne">NameError</span>: name &#39;filt_eeg&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="epoching">
<h2>Epoching<a class="headerlink" href="#epoching" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">picks_eeg</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">filt_eeg</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> 
                           <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                           <span class="n">exclude</span><span class="o">=</span><span class="p">[])</span> 

<span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">filt_eeg</span><span class="p">,</span> 
                    <span class="n">filt_eeg</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> 
                    <span class="n">event_id</span><span class="p">,</span> 
                    <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> 
                    <span class="n">proj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">picks</span><span class="o">=</span><span class="n">picks_eeg</span><span class="p">,</span> 
                    <span class="n">baseline</span><span class="o">=</span><span class="n">baseline</span><span class="p">,</span> 
                    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1482276412.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">picks_eeg</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">filt_eeg</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                            <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                            <span class="n">exclude</span><span class="o">=</span><span class="p">[])</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">filt_eeg</span><span class="p">,</span> 

<span class="ne">NameError</span>: name &#39;filt_eeg&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="print-of-epochs-in-each-condition">
<h3>Print # of epochs in each condition<a class="headerlink" href="#print-of-epochs-in-each-condition" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span> <span class="c1"># gives us number of trials per condition prior to artrej</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1890402506.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span> <span class="c1"># gives us number of trials per condition prior to artrej</span>

<span class="ne">NameError</span>: name &#39;epochs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-epochs-and-go-through-manually-marking-bad-trials">
<h2>Plot epochs and go through, manually marking bad trials<a class="headerlink" href="#plot-epochs-and-go-through-manually-marking-bad-trials" title="Permalink to this headline">¶</a></h2>
<p>Click on a trial to mark it bad. When you close the window, the marked trials will be saved to the “drops” in the epochs data structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> qt5 
<span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">.0001</span><span class="p">),</span> 
            <span class="n">n_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Epochs&#39;</span><span class="p">,</span> 
            <span class="n">picks</span><span class="o">=</span><span class="n">picks_eeg</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">3788919995.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;qt5&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">.0001</span><span class="p">),</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span>             <span class="n">n_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Epochs&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>             <span class="n">picks</span><span class="o">=</span><span class="n">picks_eeg</span><span class="p">);</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2349</span>                 <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2350</span>             <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2351</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2352</span>             <span class="k">return</span> <span class="n">result</span>
<span class="g g-Whitespace">   </span><span class="mi">2353</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/decorator.py</span> in <span class="ni">fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>                 <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">232</span>             <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>     <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>     <span class="n">fun</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/magic.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(f, *a, **k)</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>     <span class="c1"># but it&#39;s overkill for just that one bit of state.</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="k">def</span> <span class="nf">magic_deco</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">187</span>         <span class="n">call</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> 
<span class="g g-Whitespace">    </span><span class="mi">189</span>         <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/magics/pylab.py</span> in <span class="ni">matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>             <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>             <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3531</span>                 <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3532</span> 
<span class="ne">-&gt; </span><span class="mi">3533</span>         <span class="n">pt</span><span class="o">.</span><span class="n">activate_matplotlib</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3534</span>         <span class="n">configure_inline_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3535</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/pylabtools.py</span> in <span class="ni">activate_matplotlib</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>     <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> 
<span class="ne">--&gt; </span><span class="mi">359</span>     <span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> 
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="n">_needmain</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">switch_backend</span><span class="nt">(newbackend)</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="n">backend_name</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_backend_module_name</span><span class="p">(</span><span class="n">newbackend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> 
<span class="ne">--&gt; </span><span class="mi">277</span>     <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>         <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">backend_mod</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> 
<span class="g g-Whitespace">    </span><span class="mi">277</span>     <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">278</span>         <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> 
<span class="g g-Whitespace">    </span><span class="mi">280</span>     <span class="n">required_framework</span> <span class="o">=</span> <span class="n">_get_required_interactive_framework</span><span class="p">(</span><span class="n">backend_mod</span><span class="p">)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/__init__.py</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                 <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>             <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">127</span>     <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> 
<span class="g g-Whitespace">    </span><span class="mi">129</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap_external.py</span> in <span class="ni">exec_module</span><span class="nt">(self, module)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">backend_qt5agg</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cbook</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">.backend_agg</span> <span class="kn">import</span> <span class="n">FigureCanvasAgg</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">.backend_qt5</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">_BackendQT5</span><span class="p">,</span> <span class="n">FigureCanvasQT</span><span class="p">,</span> <span class="n">FigureManagerQT</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">NavigationToolbar2QT</span><span class="p">,</span> <span class="n">backend_version</span><span class="p">)</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">backend_qt5</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">_Backend</span><span class="p">,</span> <span class="n">FigureCanvasBase</span><span class="p">,</span> <span class="n">FigureManagerBase</span><span class="p">,</span> <span class="n">NavigationToolbar2</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">TimerBase</span><span class="p">,</span> <span class="n">cursors</span><span class="p">,</span> <span class="n">ToolContainerBase</span><span class="p">,</span> <span class="n">StatusbarBase</span><span class="p">,</span> <span class="n">MouseButton</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="kn">import</span> <span class="nn">matplotlib.backends.qt_editor.figureoptions</span> <span class="k">as</span> <span class="nn">figureoptions</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_editor._formsubplottool</span> <span class="kn">import</span> <span class="n">UiSubplotTool</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">qt_compat</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">qt_editor</span><span class="o">/</span><span class="n">figureoptions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">mcolors</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">image</span> <span class="k">as</span> <span class="n">mimage</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_compat</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_editor</span> <span class="kn">import</span> <span class="n">_formlayout</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> 

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">qt_compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>         <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">179</span>         <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Failed to import any qt binding&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span> <span class="k">else</span><span class="p">:</span>  <span class="c1"># We should not get there.</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>     <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Unexpected QT_API: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">QT_API</span><span class="p">))</span>

<span class="ne">ImportError</span>: Failed to import any qt binding
</pre></div>
</div>
</div>
</div>
<div class="section" id="reproducable-science">
<h3>Reproducable science<a class="headerlink" href="#reproducable-science" title="Permalink to this headline">¶</a></h3>
<p>The problem with manual rejection through the GUI is that we don’t have a record here in the script of which trials were rejected. So if we have to redo this step, it might be done differently, which will affect all subsequent steps (notably ICA).</p>
<p>Therefore, we identify the bad trials visually, but exclude them manually by listing them in the cell below (as numbers, separated by commas — the numbers at the bottom of the epochs plot are the ones you want to use).</p>
<p>Note that an alternative way to reject trials is to click on them in the interactive plot above (what I call the “click-to-reject” approach). The trial will turn red and is then removed from the data structure for all subsequent steps.
<em>BE CAREFUL</em> though, becuase <em>MNE renumbers the trials after rejection</em>. So, if you click on trials in the interactive plot, then list those trial numbers below and run <code class="docutils literal notranslate"><span class="pre">epochs.drop</span></code>, you will remove <em>double</em> the number of trials you intended - the latter half being actually-good trials.
Also, the “click” method is not a reproducible science approach, because if you re-run this notebook, you will have to re-identify and -mark the bad trials. So <strong>do not use the click-to-reject approach</strong>. If you accidentally click on a trial and it turns red, just click again to make it black before going on to the next cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rej_trials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">]</span>
<span class="c1"># indices in epochs.plot() start from 1, not 0, so we need to -1 from each index we manually identified</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rej_trials</span><span class="p">)):</span>
    <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    
<span class="n">epochs</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">rej_trials</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1612325368.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">epochs</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">rej_trials</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;epochs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-average-of-all-epochs">
<h3>Plot average of all epochs<a class="headerlink" href="#plot-average-of-all-epochs" title="Permalink to this headline">¶</a></h3>
<p>You should see big artifacts in the data, since we haven’t done artifact correction yet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">epochs</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">3640178194.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">epochs</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>

<span class="ne">NameError</span>: name &#39;epochs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="run-ica-to-identify-and-correct-ocular-artifacts">
<h1>Run ICA to identify and correct ocular artifacts<a class="headerlink" href="#run-ica-to-identify-and-correct-ocular-artifacts" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify n_components as a decimal to set % explained variance</span>
<span class="n">n_components</span> <span class="o">=</span> <span class="mf">.975</span>

<span class="n">ica</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">ICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fastica&#39;</span><span class="p">,</span> 
                            <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">ica_random_state</span><span class="p">)</span>

<span class="n">picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                       <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">3645584930.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                             <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">ica_random_state</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">8</span>                        <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 

<span class="ne">NameError</span>: name &#39;epochs&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="plot-scalp-maps-of-each-independent-component">
<h2>Plot scalp maps of each Independent Component<a class="headerlink" href="#plot-scalp-maps-of-each-independent-component" title="Permalink to this headline">¶</a></h2>
<p>Ocular artifact components should load heavily over the front of the head and little/not at all elsewhere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ch_type</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1567084550.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ch_type</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">);</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/mne/preprocessing/ica.py</span> in <span class="ni">plot_components</span><span class="nt">(self, picks, ch_type, res, vmin, vmax, cmap, sensors, colorbar, title, show, outlines, contours, image_interp, inst, plot_std, topomap_args, image_args, psd_args, reject, sphere, verbose)</span>
<span class="g g-Whitespace">   </span><span class="mi">1926</span>                         <span class="n">image_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">psd_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1927</span>                         <span class="n">sphere</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1928</span>         <span class="k">return</span> <span class="n">plot_ica_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">ch_type</span><span class="o">=</span><span class="n">ch_type</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1929</span>                                    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1930</span>                                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="n">sensors</span><span class="p">,</span>

<span class="nn">&lt;decorator-gen-158&gt;</span> in <span class="ni">plot_ica_components</span><span class="nt">(ica, picks, ch_type, res, vmin, vmax, cmap, sensors, colorbar, title, show, outlines, contours, image_interp, inst, plot_std, topomap_args, image_args, psd_args, reject, sphere, verbose)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/mne/viz/topomap.py</span> in <span class="ni">plot_ica_components</span><span class="nt">(ica, picks, ch_type, res, vmin, vmax, cmap, sensors, colorbar, title, show, outlines, contours, image_interp, inst, plot_std, topomap_args, image_args, psd_args, reject, sphere, verbose)</span>
<span class="g g-Whitespace">   </span><span class="mi">1181</span> 
<span class="g g-Whitespace">   </span><span class="mi">1182</span>     <span class="k">if</span> <span class="n">ica</span><span class="o">.</span><span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1183</span>         <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The ICA</span><span class="se">\&#39;</span><span class="s1">s measurement info is missing. Please &#39;</span>
<span class="g g-Whitespace">   </span><span class="mi">1184</span>                            <span class="s1">&#39;fit the ICA or add the corresponding info object.&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1185</span> 

<span class="ne">RuntimeError</span>: The ICA&#39;s measurement info is missing. Please fit the ICA or add the corresponding info object.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-individual-components-and-do-manual-artifact-selection">
<h2>Plot individual components and do manual artifact selection<a class="headerlink" href="#plot-individual-components-and-do-manual-artifact-selection" title="Permalink to this headline">¶</a></h2>
<p>My criteria for rejection are:</p>
<ol class="simple">
<li><p>Obvious ocular artifact (blinks weigh heavily on anterior channels, all same polarity; horizontal movements weight heavily on either side of the eyes, with opposite polarity on each side)</p></li>
</ol>
<ul class="simple">
<li><p>Raster plots show that component weights heavily on a very low number of trials, and little/not at all on most trials</p></li>
<li><p>“Epochs variance” is high on a low number of trials, and generally low on most trials</p></li>
<li><p>Topo plot shows a very focal effect around a single electrode, with very little/no weighting at most other electrodes (keeping in mind that the topo plots are interpolated so there will be some “smearing” of an effect even at a single electrode)</p></li>
<li><p>No apparent correlation between average waveform (shown in bottom of raster plot) and an IC with a clear, strong, sensory ERP (i.e., no suggestion of part or all of a P1-N-P2 complex)</p></li>
</ul>
<p>Need to manually change the “picks” number for each plot based on visual inspection of the topo plots of the components, above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_properties</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ica</span><span class="o">.</span><span class="n">n_components_</span><span class="p">),</span> <span class="n">psd_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fmax&#39;</span><span class="p">:</span> <span class="n">h_freq</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1795881591.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ica</span><span class="o">.</span><span class="n">plot_properties</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ica</span><span class="o">.</span><span class="n">n_components_</span><span class="p">),</span> <span class="n">psd_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fmax&#39;</span><span class="p">:</span> <span class="n">h_freq</span><span class="p">});</span>

<span class="ne">NameError</span>: name &#39;epochs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="manually-specify-ics-to-remove-based-on-visual-inspection">
<h2>Manually specify ICs to remove, based on visual inspection<a class="headerlink" href="#manually-specify-ics-to-remove-based-on-visual-inspection" title="Permalink to this headline">¶</a></h2>
<p>The automatic process doesn’t remove as many ICs as necessary for EEG</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="apply-ica-corrections-to-data-and-re-reference-to-average-mastoids">
<h1>Apply ICA corrections to data, and re-reference to average mastoids<a class="headerlink" href="#apply-ica-corrections-to-data-and-re-reference-to-average-mastoids" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs_postica</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">.</span><span class="n">apply_baseline</span><span class="p">(</span><span class="n">baseline</span><span class="p">)</span>
<span class="n">epochs_postica_mstd</span> <span class="o">=</span> <span class="n">set_eeg_reference</span><span class="p">(</span><span class="n">epochs_postica</span><span class="p">,</span> <span class="n">ref_channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP9&#39;</span><span class="p">,</span><span class="s1">&#39;TP10&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">interpolate_bads</span><span class="p">()</span>

<span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">4247310986.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">epochs_postica</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">.</span><span class="n">apply_baseline</span><span class="p">(</span><span class="n">baseline</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">epochs_postica_mstd</span> <span class="o">=</span> <span class="n">set_eeg_reference</span><span class="p">(</span><span class="n">epochs_postica</span><span class="p">,</span> <span class="n">ref_channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TP9&#39;</span><span class="p">,</span><span class="s1">&#39;TP10&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">interpolate_bads</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>

<span class="ne">NameError</span>: name &#39;epochs&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="check-epochs-again-and-remove-any-that-ica-didn-t-clean-up">
<h2>Check epochs again and remove any that ICA didn’t clean up<a class="headerlink" href="#check-epochs-again-and-remove-any-that-ica-didn-t-clean-up" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> qt5
<span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">.0002</span><span class="p">),</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Epochs post-ICA&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1510438078.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;qt5&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">.0002</span><span class="p">),</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Epochs post-ICA&#39;</span><span class="p">);</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2349</span>                 <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2350</span>             <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2351</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2352</span>             <span class="k">return</span> <span class="n">result</span>
<span class="g g-Whitespace">   </span><span class="mi">2353</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/decorator.py</span> in <span class="ni">fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>                 <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">232</span>             <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>     <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>     <span class="n">fun</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/magic.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(f, *a, **k)</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>     <span class="c1"># but it&#39;s overkill for just that one bit of state.</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="k">def</span> <span class="nf">magic_deco</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">187</span>         <span class="n">call</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> 
<span class="g g-Whitespace">    </span><span class="mi">189</span>         <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/magics/pylab.py</span> in <span class="ni">matplotlib</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>             <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available matplotlib backends: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">backends_list</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">99</span>             <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">enable_matplotlib</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_show_matplotlib_backend</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">gui</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">enable_matplotlib</span><span class="nt">(self, gui)</span>
<span class="g g-Whitespace">   </span><span class="mi">3531</span>                 <span class="n">gui</span><span class="p">,</span> <span class="n">backend</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">find_gui_and_backend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pylab_gui_select</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3532</span> 
<span class="ne">-&gt; </span><span class="mi">3533</span>         <span class="n">pt</span><span class="o">.</span><span class="n">activate_matplotlib</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3534</span>         <span class="n">configure_inline_support</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3535</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/IPython/core/pylabtools.py</span> in <span class="ni">activate_matplotlib</span><span class="nt">(backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>     <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span> 
<span class="ne">--&gt; </span><span class="mi">359</span>     <span class="n">plt</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> 
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="n">_needmain</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">switch_backend</span><span class="nt">(newbackend)</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="n">backend_name</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_backend_module_name</span><span class="p">(</span><span class="n">newbackend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> 
<span class="ne">--&gt; </span><span class="mi">277</span>     <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">278</span>         <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ni">backend_mod</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> 
<span class="g g-Whitespace">    </span><span class="mi">277</span>     <span class="k">class</span> <span class="nc">backend_mod</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">backend_bases</span><span class="o">.</span><span class="n">_Backend</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">278</span>         <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">backend_name</span><span class="p">)))</span>
<span class="g g-Whitespace">    </span><span class="mi">279</span> 
<span class="g g-Whitespace">    </span><span class="mi">280</span>     <span class="n">required_framework</span> <span class="o">=</span> <span class="n">_get_required_interactive_framework</span><span class="p">(</span><span class="n">backend_mod</span><span class="p">)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/__init__.py</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                 <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>             <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">127</span>     <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> 
<span class="g g-Whitespace">    </span><span class="mi">129</span> 

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_load_unlocked</span><span class="nt">(spec)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap_external.py</span> in <span class="ni">exec_module</span><span class="nt">(self, module)</span>

<span class="nn">~/miniforge3/envs/eeg/lib/python3.9/importlib/_bootstrap.py</span> in <span class="ni">_call_with_frames_removed</span><span class="nt">(f, *args, **kwds)</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">backend_qt5agg</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">cbook</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">.backend_agg</span> <span class="kn">import</span> <span class="n">FigureCanvasAgg</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">.backend_qt5</span> <span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">_BackendQT5</span><span class="p">,</span> <span class="n">FigureCanvasQT</span><span class="p">,</span> <span class="n">FigureManagerQT</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">NavigationToolbar2QT</span><span class="p">,</span> <span class="n">backend_version</span><span class="p">)</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">backend_qt5</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">_Backend</span><span class="p">,</span> <span class="n">FigureCanvasBase</span><span class="p">,</span> <span class="n">FigureManagerBase</span><span class="p">,</span> <span class="n">NavigationToolbar2</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">TimerBase</span><span class="p">,</span> <span class="n">cursors</span><span class="p">,</span> <span class="n">ToolContainerBase</span><span class="p">,</span> <span class="n">StatusbarBase</span><span class="p">,</span> <span class="n">MouseButton</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="kn">import</span> <span class="nn">matplotlib.backends.qt_editor.figureoptions</span> <span class="k">as</span> <span class="nn">figureoptions</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_editor._formsubplottool</span> <span class="kn">import</span> <span class="n">UiSubplotTool</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">qt_compat</span>

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">qt_editor</span><span class="o">/</span><span class="n">figureoptions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">mcolors</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">image</span> <span class="k">as</span> <span class="n">mimage</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_compat</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">from</span> <span class="nn">matplotlib.backends.qt_editor</span> <span class="kn">import</span> <span class="n">_formlayout</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> 

<span class="o">~/</span><span class="n">miniforge3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">eeg</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">backends</span><span class="o">/</span><span class="n">qt_compat</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>         <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">179</span>         <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Failed to import any qt binding&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span> <span class="k">else</span><span class="p">:</span>  <span class="c1"># We should not get there.</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>     <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Unexpected QT_API: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">QT_API</span><span class="p">))</span>

<span class="ne">ImportError</span>: Failed to import any qt binding
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rej_trials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">114</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rej_trials</span><span class="p">)):</span>
    <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    
<span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">rej_trials</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1050904555.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rej_trials</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">rej_trials</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;epochs_postica_mstd&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">epochs_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">2936164285.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">epochs_postica_mstd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">epochs_fname</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;epochs_postica_mstd&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="create-evoked-responses-averaged-epochs-for-each-condition">
<h1>Create Evoked Responses (averaged epochs for each condition)<a class="headerlink" href="#create-evoked-responses-averaged-epochs-for-each-condition" title="Permalink to this headline">¶</a></h1>
<p>This will save a file of the evoked data as well, which you will load in later, in a different script, for group data analysis).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evokeds</span> <span class="o">=</span> <span class="p">{</span><span class="n">cond</span><span class="p">:</span><span class="n">epochs_postica_mstd</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span> 
           <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">event_id</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

<span class="n">mne</span><span class="o">.</span><span class="n">write_evokeds</span><span class="p">(</span><span class="n">evoked_fname</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">798352707.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evokeds</span> <span class="o">=</span> <span class="p">{</span><span class="n">cond</span><span class="p">:</span><span class="n">epochs_postica_mstd</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>            <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">event_id</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">mne</span><span class="o">.</span><span class="n">write_evokeds</span><span class="p">(</span><span class="n">evoked_fname</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="nn">/var/folders/9s/6fvdmxlx00z9sz6ftkrnh8dw0000gn/T/ipykernel_53129/798352707.py</span> in <span class="ni">&lt;dictcomp&gt;</span><span class="nt">(.0)</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">evokeds</span> <span class="o">=</span> <span class="p">{</span><span class="n">cond</span><span class="p">:</span><span class="n">epochs_postica_mstd</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>            <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">event_id</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">mne</span><span class="o">.</span><span class="n">write_evokeds</span><span class="p">(</span><span class="n">evoked_fname</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="ne">NameError</span>: name &#39;epochs_postica_mstd&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="plot-averaged-erp-for-each-condition">
<h2>Plot averaged ERP for each condition<a class="headerlink" href="#plot-averaged-erp-for-each-condition" title="Permalink to this headline">¶</a></h2>
<p>Note that for any image in a jupyter notebook (such as these plots), you can right-click and “save as” to save it as an image file (e.g., for inclusion in your lab report).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">matplotlib</span> <span class="n">inline</span>
<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">evokeds</span><span class="p">:</span>
    <span class="n">evokeds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="n">cond</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>UsageError: Line magic function `%` not found.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="topoplots-for-each-condition">
<h2>Topoplots for each condition<a class="headerlink" href="#topoplots-for-each-condition" title="Permalink to this headline">¶</a></h2>
<p>In 100 ms steps</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Specify times to plot at, in sec, as [min], [max], [stepsize]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">evokeds</span><span class="p">):</span>
    <span class="p">[</span><span class="n">evokeds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">outlines</span><span class="o">=</span><span class="s1">&#39;skirt&#39;</span><span class="p">,</span> 
                                <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> 
                                <span class="n">title</span><span class="o">=</span><span class="n">cond</span><span class="p">,</span>
                                <span class="n">vmin</span><span class="o">=-</span><span class="mf">10.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">)];</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">2228355503.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">evokeds</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="p">[</span><span class="n">evokeds</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">outlines</span><span class="o">=</span><span class="s1">&#39;skirt&#39;</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">7</span>                                 <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span>

<span class="ne">NameError</span>: name &#39;evokeds&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-each-condition-overlaid-at-one-electrode">
<h2>Plot each condition, overlaid, at one electrode<a class="headerlink" href="#plot-each-condition-overlaid-at-one-electrode" title="Permalink to this headline">¶</a></h2>
<p>You can replace ‘Cz’ with channel name desired</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pick</span> <span class="o">=</span> <span class="n">evokeds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Cz&#39;</span><span class="p">)</span>

<span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span><span class="n">evokeds</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">pick</span><span class="p">,</span> 
                             <span class="n">ylim</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]));</span>
<span class="c1"># note that the &#39;ylim&#39; line above sets the microvolt scale. Adjust as needed for your data.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">3755665552.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pick</span> <span class="o">=</span> <span class="n">evokeds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Cz&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span><span class="n">evokeds</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">pick</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span>                              <span class="n">ylim</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]));</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># note that the &#39;ylim&#39; line above sets the microvolt scale. Adjust as needed for your data.</span>

<span class="ne">NameError</span>: name &#39;evokeds&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="compute-between-condition-differences">
<h1>Compute Between-Condition Differences<a class="headerlink" href="#compute-between-condition-differences" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">contr</span><span class="p">:</span><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span><span class="p">([</span><span class="n">evokeds</span><span class="p">[</span><span class="n">expt_contrasts</span><span class="p">[</span><span class="n">contr</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> 
                                   <span class="o">-</span><span class="n">evokeds</span><span class="p">[</span><span class="n">expt_contrasts</span><span class="p">[</span><span class="n">contr</span><span class="p">][</span><span class="mi">1</span><span class="p">]]],</span>
                                  <span class="n">weights</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> 
         <span class="k">for</span> <span class="n">contr</span> <span class="ow">in</span> <span class="n">expt_contrasts</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1358682773.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">diffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">contr</span><span class="p">:</span><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span><span class="p">([</span><span class="n">evokeds</span><span class="p">[</span><span class="n">expt_contrasts</span><span class="p">[</span><span class="n">contr</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                    <span class="o">-</span><span class="n">evokeds</span><span class="p">[</span><span class="n">expt_contrasts</span><span class="p">[</span><span class="n">contr</span><span class="p">][</span><span class="mi">1</span><span class="p">]]],</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                                   <span class="n">weights</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span>          <span class="k">for</span> <span class="n">contr</span> <span class="ow">in</span> <span class="n">expt_contrasts</span><span class="p">}</span>

<span class="nn">/var/folders/9s/6fvdmxlx00z9sz6ftkrnh8dw0000gn/T/ipykernel_53129/1358682773.py</span> in <span class="ni">&lt;dictcomp&gt;</span><span class="nt">(.0)</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">diffs</span> <span class="o">=</span> <span class="p">{</span><span class="n">contr</span><span class="p">:</span><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span><span class="p">([</span><span class="n">evokeds</span><span class="p">[</span><span class="n">expt_contrasts</span><span class="p">[</span><span class="n">contr</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> 
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                    <span class="o">-</span><span class="n">evokeds</span><span class="p">[</span><span class="n">expt_contrasts</span><span class="p">[</span><span class="n">contr</span><span class="p">][</span><span class="mi">1</span><span class="p">]]],</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                                   <span class="n">weights</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span>          <span class="k">for</span> <span class="n">contr</span> <span class="ow">in</span> <span class="n">expt_contrasts</span><span class="p">}</span>

<span class="ne">NameError</span>: name &#39;evokeds&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="plot-difference-waves">
<h2>Plot difference waves<a class="headerlink" href="#plot-difference-waves" title="Permalink to this headline">¶</a></h2>
<div class="section" id="plot-each-contrast-overlaid-at-one-electrode">
<h3>Plot each contrast, overlaid, at one electrode<a class="headerlink" href="#plot-each-contrast-overlaid-at-one-electrode" title="Permalink to this headline">¶</a></h3>
<p>You can replace ‘Cz’ with channel name desired</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pick</span> <span class="o">=</span> <span class="n">evokeds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Cz&#39;</span><span class="p">)</span>

<span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">pick</span><span class="p">,</span>
                            <span class="n">ylim</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">3292300033.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pick</span> <span class="o">=</span> <span class="n">evokeds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">evokeds</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Cz&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">pick</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                             <span class="n">ylim</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]));</span>

<span class="ne">NameError</span>: name &#39;evokeds&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-topomaps-of-differences-at-100-ms-intervals">
<h3>Plot topomaps of differences at 100 ms intervals<a class="headerlink" href="#plot-topomaps-of-differences-at-100-ms-intervals" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    
<span class="p">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">contr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">outlines</span><span class="o">=</span><span class="s1">&#39;skirt&#39;</span><span class="p">,</span> 
                           <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> 
                           <span class="n">title</span><span class="o">=</span><span class="n">contr</span><span class="p">,</span>
                           <span class="n">vmin</span><span class="o">=-</span><span class="mf">3.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">contr</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">expt_contrasts</span><span class="p">)};</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">2242655072.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="p">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">contr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">outlines</span><span class="o">=</span><span class="s1">&#39;skirt&#39;</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span>                            <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>                            <span class="n">title</span><span class="o">=</span><span class="n">contr</span><span class="p">,</span>

<span class="nn">/var/folders/9s/6fvdmxlx00z9sz6ftkrnh8dw0000gn/T/ipykernel_53129/2242655072.py</span> in <span class="ni">&lt;setcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="p">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">contr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">outlines</span><span class="o">=</span><span class="s1">&#39;skirt&#39;</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span>                            <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>                            <span class="n">title</span><span class="o">=</span><span class="n">contr</span><span class="p">,</span>

<span class="ne">NameError</span>: name &#39;diffs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-mean-amplitude-over-time-window-of-interest">
<h2>Plot mean amplitude over time window of interest<a class="headerlink" href="#plot-mean-amplitude-over-time-window-of-interest" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tw</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.300</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">)</span>

<span class="n">tw_ctr</span> <span class="o">=</span> <span class="p">(</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tw_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="p">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">contr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">tw_ctr</span><span class="p">,</span> 
                              <span class="n">average</span><span class="o">=</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="n">ch_type</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">,</span> 
                              <span class="n">show_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                              <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                              <span class="n">size</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> 
                              <span class="n">res</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                              <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">contr</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span> <span class="o">+</span> <span class="n">tw_text</span> <span class="o">+</span> <span class="s1">&#39; ms&#39;</span><span class="p">),</span>
                              <span class="n">vmin</span><span class="o">=-</span><span class="mf">3.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">3.</span>
                             <span class="p">)</span>
 <span class="k">for</span> <span class="n">contr</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">expt_contrasts</span><span class="p">)};</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">9</span><span class="n">s</span><span class="o">/</span><span class="mi">6</span><span class="n">fvdmxlx00z9sz6ftkrnh8dw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_53129</span><span class="o">/</span><span class="mf">1355097323.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">tw_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="p">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">contr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">tw_ctr</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">7</span>                               <span class="n">average</span><span class="o">=</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>                               <span class="n">ch_type</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">,</span>

<span class="nn">/var/folders/9s/6fvdmxlx00z9sz6ftkrnh8dw0000gn/T/ipykernel_53129/1355097323.py</span> in <span class="ni">&lt;setcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">tw_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="p">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">contr</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">tw_ctr</span><span class="p">,</span> 
<span class="g g-Whitespace">      </span><span class="mi">7</span>                               <span class="n">average</span><span class="o">=</span><span class="n">tw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">tw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>                               <span class="n">ch_type</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">,</span>

<span class="ne">NameError</span>: name &#39;diffs&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./eeg/_extra"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Aaron J Newman<br/>
        
            &copy; Copyright 2020-21. This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Unported License.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>