
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Segmentation into ERP epochs &#8212; Neural Data Science in Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-1SNTM6T50K"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-1SNTM6T50K');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-1SNTM6T50K');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '7-eeg/erp_segmentation';</script>
    <link rel="canonical" href="http://neuraldatascience.io/7-eeg/erp_segmentation.html" />
    <link rel="icon" href="../_static/NESC3505_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Averaging and Re-Referencing ERPs" href="erp_avg_reref.html" />
    <link rel="prev" title="Artifacts in EEG Data" href="erp_artifacts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/NESC3505_icon.png" class="logo__image only-light" alt="Neural Data Science in Python - Home"/>
    <img src="../_static/NESC3505_icon.png" class="logo__image only-dark pst-js-only" alt="Neural Data Science in Python - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Neural Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About This Course</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1-intro/why.html">Start with why</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1-intro/learning_objectives.html">Learning Objectives for this Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-intro/learning_approach.html">How to Approach this Course</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/actually_write_code.html">Actually Write Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/mindset.html">Mindset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/flipped_classroom.html">Flipped Classroom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/errors_debugging.html">Errors and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/ai.html">Artificial Intelligence-Assisted Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/teamwork.html">Collaboration and Teamwork</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-intro/pedagogy.html">Pedagogy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/teaching_approach.html">Teaching Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/authenticity.html">Authenticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/21st_cen_skills.html">21st Century Skills</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/constructivism.html">Constructivism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/connectivism.html">Connectivism</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-intro/open.html">Open Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/software.html">Free Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/free_licenses.html">Free and Open-Source Software Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/open_science.html">Open Science</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/peer_review.html">Peer Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/for_profit.html">For-Profit Publishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/impact_factors.html">Impact Factors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/novelty.html">Novelty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/open_publishing.html">Open Publishing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/preregistration.html">Preregistration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/open_methods.html">Open Methods and Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/oer.html">Open Educational Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/oer_this_course.html">OERs in the Context of this Course</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-intro/licenses.html">Licenses</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2-nds/introduction.html">Getting Started with the Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2-nds/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-nds/what_is_nds.html">What is Data Science?</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/data.html">What is Data?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/where.html">Where Does Neural Data Come From?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/data_science.html">Data Science</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/data_cleaning.html">Data Cleaning</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-nds/tools_for_nds.html">Tools for Neural Data Science</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/spreadsheets.html">Spreadsheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/spreadsheets_limits.html">Limitations of Spreadsheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/reproducibility.html">Reproducibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/sci_prog_lang.html">Scientific Programming Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/which_lang.html">Which language to use?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/libs.html">Libraries and packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/why_python.html">Why Python for this Course?</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-nds/coding.html">Coding Tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/terminal.html">The Terminal and Command Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/jupyter.html">Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/markdown.html">Markdown</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/vscode.html">Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-nds/github.html">GitHub</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Set Up Your Computer for Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2b-setup/introduction.html">Some Assembly Required</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2b-setup/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2b-setup/first_steps.html">First Steps</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/github.html">Get on GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/codespaces.html">GitHub Codespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/github_classroom.html">GitHub Classroom</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2b-setup/install_tools.html">Install on Your Computer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/anaconda.html">Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/miniconda.html">Miniconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/vscode.html">VS Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/github_desktop.html">GitHub Desktop</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2b-setup/first_repo.html">Your First GitHub Repository</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/clone.html">Clone a Repository from GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/github_repo.html">Exploring the GitHub Repository view</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/repo_in_vscode.html">Open the Repository in VS Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/edit_commit_push.html">Editing, Pushing, and Committing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/edit_readme.html">Edit the README File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2b-setup/new_markdown_file.html">Create a New Markdown File</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../2b-setup/getting_help.html">Getting Help on an Assignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2b-setup/submitting_assignments.html">Submitting Assignments</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introducing Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3-python/introduction.html">Introducing Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3-python/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3-python/preliminaries.html">Preliminaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-python/jupyter_intro.html">Working with Jupyter Notebooks</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3-python/getting_help.html">Getting Help with Python</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3-python/data_types.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-python/variables_assignment.html">Variables and Assignment</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3-python/types_conversion.html">Data Types and Conversion</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3-python/builtin.html">Python Built-Ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-python/lists.html">Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-python/dictionaries.html">Dictionaries</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3-python/flow_control.html">Flow Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-python/for_loops.html"><code class="docutils literal notranslate"><span class="pre">for</span></code> Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-python/conditionals.html">Conditionals</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3-python/working_w_data.html">Working with Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-python/pandas_dataframes.html">pandas DataFrames</a></li>


<li class="toctree-l2"><a class="reference internal" href="../3-python/looping_data_files.html">Looping Over Data Files</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">AI-Assisted Coding</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3b-ai_assisted/introduction.html">Introducing GitHub Copilot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3b-ai_assisted/ai_assisted.html">Introduction to GitHub Copilot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3b-ai_assisted/rt_data.html">Exercises – Reaction Time Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3b-ai_assisted/pandas_copilot.html">Data Files and pandas DataFrames</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3b-ai_assisted/multi_data_files.html">Working With Multiple Data Files Using Copilot</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3b-ai_assisted/multi_data_files_1.html">Reading Data Files with pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3b-ai_assisted/multi_data_files_2.html">Computing Mean Reaction Times and Confidence Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3b-ai_assisted/multi_data_files_3.html">Formatting the Output in a Table</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualizing Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../4-viz/introduction.html">Introduction to Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/plotting.html">Introduction to Plotting with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/proc_vs_oo.html">Procedural versus Object-Oriented Plotting in Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/subplots.html">Subplots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/plotting_types.html">Thinking About Data for Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/seaborn.html">Data Science Plots with Seaborn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4-viz/human_factors.html">Accessibility and Human Factors in Plotting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5-eda/introduction.html">Introduction to EDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5-eda/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5-eda/repeated_measures.html">Working with Repeated Measures Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5-eda/data_cleaning.html">Data Cleaning - Dealing with Outliers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5-eda/ttests.html">Basic Statistics in Python: <em>t</em> tests with SciPy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Single Unit Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../6-single_unit/introduction.html">Introduction to Single Unit Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6-single_unit/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../6-single_unit/single_unit_intro.html">Single Unit Data and Spike Trains</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../6-single_unit/intro_spike_trains.html">Introduction to Spike Train Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6-single_unit/ten_intensities.html">Effects of Light Intensity on Spike Rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6-single_unit/heat_maps.html">Heat Maps</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../6-single_unit/intro_multielec_data.html">Introducing Multielectrode Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../6-single_unit/pandas_multielec.html">Working with Multielectrode Data in pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6-single_unit/corr_spike_trains.html">Correlating spike trains</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EEG Data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to EEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_eeg.html">What is EEG?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="approaches.html">EEG in the Time and Frequency Domains</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="time_freq.html">Time and Frequency Domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="erps.html">Event-Related Potentials (ERPs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">ERP Components</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="mne_python.html">MNE-Python</a></li>


<li class="toctree-l1 current active has-children"><a class="reference internal" href="erp_preprocessing.html">EEG-ERP Preprocessing</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="erp_filtering.html">Filtering EEG Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="erp_artifacts.html">Artifacts in EEG Data</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Segmentation into ERP epochs</a></li>
<li class="toctree-l2"><a class="reference internal" href="erp_avg_reref.html">Averaging and Re-Referencing ERPs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="erp_group.html">Group Analysis of ERP Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="erp_group_viz.html">Grand Averages and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="erp_group_stats.html">Statistical Analysis of ERP Data</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MRI Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../8-mri/introduction.html">Introduction to MRI Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8-mri/learning_objectives.html">Learning Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8-mri/read_viz.html">Reading and Visualizing Structural MRI Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8-mri/nifti.html">Working with NIfTI images</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../9-machine_learning/introduction.html">Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../zrefs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/neural-data-science/NESC_3505_textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neural-data-science/NESC_3505_textbook/issues/new?title=Issue%20on%20page%20%2F7-eeg/erp_segmentation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/7-eeg/erp_segmentation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Segmentation into ERP epochs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-mne-and-read-filtered-data">Import MNE and Read Filtered Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mne-s-events-structure">MNE’s events structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#about-event-codes">About Event Codes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-event-dictionary">The Event Dictionary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-mne-interprets-event-codes">How MNE Interprets Event Codes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#label-event-codes-mapping-between-dictionaries">Label Event Codes – Mapping Between Dictionaries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-events-over-time">Plot Events Over Time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#segment-the-data-into-epochs">Segment the data into epochs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-and-indexing-epochs">Viewing and Indexing Epochs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-average-erp-across-conditions-of-interest-before-artifact-correction">Visualize Average ERP Across Conditions of Interest – Before Artifact Correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-ica-correction-to-epochs">Apply ICA correction to epochs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-average-erp-after-ica-artifact-removal">Visualize Average ERP After ICA Artifact Removal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autoreject-for-final-data-cleaning">AutoReject for Final Data Cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-autoreject-s-effects">View AutoReject’s Effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-average-erp-after-autoreject">Visualize Average ERP After AutoReject</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalp-topography-maps">Scalp topography maps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-epochs">Save epochs</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="segmentation-into-erp-epochs">
<h1>Segmentation into ERP epochs<a class="headerlink" href="#segmentation-into-erp-epochs" title="Link to this heading">#</a></h1>
<p>In this lesson we will learn how to segment continuous EEG data into epochs, time-locked to experimental events of interest. This is the stage at which we move from working with EEG data, to ERP data. Recall that <em>ERP</em> stands for <em>event-related potential</em> — short segments of EEG data that are time-locked to particular events such as stimulus onsets or participant responses. In the previous steps we removed artifacts from the continuous EEG data. Now, we will segment the data into epochs, and apply artifact correction to the segments, based on the ICA decomposition that we performed in the previous step, as well as using the AutoReject algorithm to automatically detect and remove bad epochs and channels that ICA may not fix.</p>
<section id="import-mne-and-read-filtered-data">
<h2>Import MNE and Read Filtered Data<a class="headerlink" href="#import-mne-and-read-filtered-data" title="Link to this heading">#</a></h2>
<p>We will segment the band-pass filtered version of the continuous EEG data that we created in the filtering lesson</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="n">mne</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>  <span class="c1"># reduce extraneous MNE output</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Participant ID code</span>
<span class="n">p_id</span> <span class="o">=</span> <span class="s1">&#39;sub-001&#39;</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;data/&#39;</span> <span class="o">+</span> <span class="n">p_id</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

<span class="n">raw_filt</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="n">p_id</span> <span class="o">+</span> <span class="s1">&#39;-filt-raw.fif&#39;</span><span class="p">)</span>
<span class="n">raw_filt</span><span class="o">.</span><span class="n">set_montage</span><span class="p">(</span><span class="s1">&#39;easycap-M1&#39;</span><span class="p">)</span>                                  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-aa9da5d0-1513-4900-88b2-249f98e6b040"  title="Hide section" 
    onclick="toggleVisibility('general-aa9da5d0-1513-4900-88b2-249f98e6b040')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-aa9da5d0-1513-4900-88b2-249f98e6b040 ">
    <td class="repr-section-toggle-col"></td>
    <td>Filename(s)</td>
    <td>
        
        sub-001-filt-raw.fif
        
        
    </td>
</tr>

<tr class="repr-element general-aa9da5d0-1513-4900-88b2-249f98e6b040 ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Raw</td>
</tr>
<tr class="repr-element general-aa9da5d0-1513-4900-88b2-249f98e6b040 ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-aa9da5d0-1513-4900-88b2-249f98e6b040 ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-aa9da5d0-1513-4900-88b2-249f98e6b040 ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-bc5c874e-d763-4fba-ba00-5f7a15c207ba" 
    title="Hide section"  onclick="toggleVisibility('acquisition-bc5c874e-d763-4fba-ba00-5f7a15c207ba')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>

<tr class="repr-element acquisition-bc5c874e-d763-4fba-ba00-5f7a15c207ba ">
    <td class="repr-section-toggle-col"></td>
    <td>Duration</td>
    <td>00:13:38 (HH:MM:SS)</td>
</tr>








<tr class="repr-element acquisition-bc5c874e-d763-4fba-ba00-5f7a15c207ba ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-bc5c874e-d763-4fba-ba00-5f7a15c207ba ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>408,640</td>
</tr>


    







<tr class="repr-section-header channels-41580e68-22fa-4f43-86b4-48a8378de88b"  title="Hide section" 
    onclick="toggleVisibility('channels-41580e68-22fa-4f43-86b4-48a8378de88b')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-41580e68-22fa-4f43-86b4-48a8378de88b ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-41580e68-22fa-4f43-86b4-48a8378de88b ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-1dbe218c-1203-45cc-a4c7-fa4675ac7ba7"  title="Hide section" 
    onclick="toggleVisibility('filters-1dbe218c-1203-45cc-a4c7-fa4675ac7ba7')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-1dbe218c-1203-45cc-a4c7-fa4675ac7ba7 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-1dbe218c-1203-45cc-a4c7-fa4675ac7ba7 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<section id="mne-s-events-structure">
<h3>MNE’s events structure<a class="headerlink" href="#mne-s-events-structure" title="Link to this heading">#</a></h3>
<p><strong>Event codes</strong> indicate when events of experimental interest occurred during the EEG recording. They are typically generated by the stimulus computer, and sent to the EEG recording computer at the same time that the stimuli are presented to the participant. Event codes may also mark when a participant made a response (such as a button press, or the onset of a vocal response), or other information such as the start of a new bock of trials or condition, rather than a specific stimulus.</p>
<p>Segmenting the data into ERPs depends on these event codes, since they are what we time-lock to. To use them for ERP segmentation, we need to first extract the timing and identity of each code from the raw data, and store it in a NumPy array. Because event codes are numeric (for reasons explained below), we also need to define a mapping between these numbers and meaningful labels (such as what type of stimulus or experimental condition the code denotes).</p>
<p>We use <code class="docutils literal notranslate"><span class="pre">mne.events_from_annotations()</span></code> to extract the event codes from the raw data and store them in a NumPy array called <code class="docutils literal notranslate"><span class="pre">events</span></code>. The function actually produces two outputs; the second is a dictionary mapping the event codes to labels, which we assign to <code class="docutils literal notranslate"><span class="pre">events_dict</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span><span class="p">,</span> <span class="n">events_dict</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">events_from_annotations</span><span class="p">(</span><span class="n">raw_filt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can view the first 10 rows of the <code class="docutils literal notranslate"><span class="pre">events</span></code> array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[    0,     0,     2],
       [    0,     0,     1],
       [25550,     0,     7],
       [25553,     0,     3],
       [26099,     0,    13],
       [26144,     0,     4],
       [29582,     0,     5],
       [33283,     0,     3],
       [33781,     0,    15],
       [34932,     0,     5]])
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">events</span></code> is a NumPy array with 3 columns, and one row for each event code in the data.</p>
<p>The <strong>first column</strong> contains the index of the event code in terms of the data array. Recall that the data were sampled at a rate of 500 Hz, meaning we have one sample (i.e., measurement) every 2 ms. So the values in the first column of <code class="docutils literal notranslate"><span class="pre">events</span></code> are not time measured in milliseconds, but “time” in terms of samples or data points. This is important to remember later, although MNE generally makes it easy to go between samples and more intuitive measures of time like milliseconds or seconds.</p>
<p>The <strong>second column</strong> is usually zero, but is intended to mark the end time off an event, if the event code was send to the EEG system for a period of time. In practice it is rarely used, and we will ignore it.</p>
<p>The <strong>third column</strong> is the event code itself, as an integer. We’ll elaborate later on what each code means.</p>
</section>
<section id="about-event-codes">
<h3>About Event Codes<a class="headerlink" href="#about-event-codes" title="Link to this heading">#</a></h3>
<p>Most EEG systems receive event codes from the stimulus computer using an electronic communications protocol called <strong>TTL</strong>, or transistor-to-transistor logic. It’s very simple and low-level, and is done via the parallel port of a computer (which is so low-level, computers almost never have these built in anymore). The reason this arcane system is still routinely used in EEG is that its timing is very precise, which means it is the best option to get millisecond-level synchronization between when the stimulus computer presents a stimulus, and when the event code is received by the EEG system. This level of precision is vital in EEG research because the effects of interest occur on a millisecond time scale. The impact of this system for us is that the event codes stored in an EEG data file are usually restricted to integers in the range of 1–255, because that is the (8 bit) resolution of the TTL protocol (i.e., this kind of connection can inherently only send this range of values). Some EEG recording software allows the experimenter to specify text labels for each numerical event code, based on what the numbers mean in that particular experiment. However, in most cases mapping between the numerical event codes and meaningful labels is something we do in preprocessing, as shown below.</p>
<div class="admonition-lab-streaming-layer-lsl admonition">
<p class="admonition-title">Lab Streaming Layer (LSL)</p>
<p>A modern replacement for TTL signals is the <a class="reference external" href="https://labstreaminglayer.org/"><strong>Lab Streaming Layer</strong></a> (LSL), which is a software-based system for sending event codes and other data between computers. LSL involves one computer running an LSL server application, which other computers (or processes on the same computer) send data to via a network connection. LSL has a sophisticated way of synchronizing timing between multiple computers, which allows for good temporal precision. Besides not requiring computers that have parallel ports, LSL can aggregate data streams from a variety of sources, including stimulus presentation software, EEG and fNIRS systems, eye trackers, motion capture systems, and more. In the present data sets we use TTL codes, however MNE supports LSL and the processes demonstrated here are similar for LSL data.</p>
</div>
</section>
<section id="the-event-dictionary">
<h3>The Event Dictionary<a class="headerlink" href="#the-event-dictionary" title="Link to this heading">#</a></h3>
<p>When MNE reads the event codes from a raw data file, it does a step that isn’t always intuitive. Event codes in raw data files can take a variety of forms, depending on the software that was used to record the data. MNE searches through the raw data, and finds each unique event code (keeping in mind that event codes typically indicate a category of stimuli, or experimental condition, not the identity of individual stimuli or trials). MNE treats the event codes as strings, even if they are all numeric. MNE then assigns each unique event code an integer value. This mapping between original event codes and integers is stored in a dictionary called <code class="docutils literal notranslate"><span class="pre">events_dict</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Comment/actiCAP Data On&#39;: 1,
 &#39;New Segment/&#39;: 2,
 &#39;Stimulus/S  1&#39;: 3,
 &#39;Stimulus/S  2&#39;: 4,
 &#39;Stimulus/S  3&#39;: 5,
 &#39;Stimulus/S  4&#39;: 6,
 &#39;Stimulus/S  5&#39;: 7,
 &#39;Stimulus/S  7&#39;: 8,
 &#39;Stimulus/S101&#39;: 9,
 &#39;Stimulus/S102&#39;: 10,
 &#39;Stimulus/S111&#39;: 11,
 &#39;Stimulus/S112&#39;: 12,
 &#39;Stimulus/S201&#39;: 13,
 &#39;Stimulus/S202&#39;: 14,
 &#39;Stimulus/S211&#39;: 15,
 &#39;Stimulus/S212&#39;: 16}
</pre></div>
</div>
</div>
</div>
<p>In the above dictionary, the original event codes are the dictionary keys (on the left of the colons). You can see that the first two entries are not of experimental interest, but simply note the start of recording. The other event codes were originally numeric, but the recording software pre-pended <code class="docutils literal notranslate"><span class="pre">Stimulus/S</span></code> to the start of each one. MNE has simply matched each one to an integer, so the event codes used in MNE don’t match the original event codes. This is why <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> is critical to ensuring that you map the right event codes to the each event of experimental interest. Another step is required, though, because we need a way of mapping from the the codes that MNE is using in the data, to the labels for the events that make sense to us in terms of the experiment (e.g., different stimulus types, response onsets, etc.).</p>
</section>
<section id="how-mne-interprets-event-codes">
<h3>How MNE Interprets Event Codes<a class="headerlink" href="#how-mne-interprets-event-codes" title="Link to this heading">#</a></h3>
<p>There is actually a workaround for this. In the present case, we imported the filtered data that we created in a previous lesson. If instead we had applied <code class="docutils literal notranslate"><span class="pre">mne.events_from_annotations()</span></code> to the original <code class="docutils literal notranslate"><span class="pre">raw</span></code> data file, MNE would be able to parse the event codes, and will assign them the same integer values that they had in the original data file. This is because the original data file was in the BrainVision format, which stores the event codes in a way that MNE can read. However, if you apply <code class="docutils literal notranslate"><span class="pre">mne.events_from_annotations()</span></code> to the <code class="docutils literal notranslate"><span class="pre">raw_filt</span></code> data file, MNE will not be able to parse the event codes, because the data file is in the <code class="docutils literal notranslate"><span class="pre">.fif</span></code> format, which stores the event codes differently. In this case, MNE will assign new integer values to the event codes, starting at 1 for the first event code it finds in the file, as we see here.</p>
<p>For reference, let’s see the difference when we read the original raw file. Since we only want the event codes, and not the data,  we can speed the process up by setting the kwarg <code class="docutils literal notranslate"><span class="pre">preload=False</span></code>. This tells MNE to read the metadata from the file, but not the data itself. This also saves memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_brainvision</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="n">p_id</span> <span class="o">+</span> <span class="s1">&#39;.vhdr&#39;</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">raw_filt</span>

<span class="n">events_raw</span><span class="p">,</span> <span class="n">events_dict_raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">events_from_annotations</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="n">events_dict_raw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Comment/actiCAP Data On&#39;: 10001,
 &#39;New Segment/&#39;: 99999,
 &#39;Stimulus/S  1&#39;: 1,
 &#39;Stimulus/S  2&#39;: 2,
 &#39;Stimulus/S  3&#39;: 3,
 &#39;Stimulus/S  4&#39;: 4,
 &#39;Stimulus/S  5&#39;: 5,
 &#39;Stimulus/S  7&#39;: 7,
 &#39;Stimulus/S101&#39;: 101,
 &#39;Stimulus/S102&#39;: 102,
 &#39;Stimulus/S111&#39;: 111,
 &#39;Stimulus/S112&#39;: 112,
 &#39;Stimulus/S201&#39;: 201,
 &#39;Stimulus/S202&#39;: 202,
 &#39;Stimulus/S211&#39;: 211,
 &#39;Stimulus/S212&#39;: 212}
</pre></div>
</div>
</div>
</div>
<p>In practice it would make sense to read in the original raw file here to get the event codes. However, we will continue with the filtered data, because it provides an opportunity to demonstrate how to re-map information between two Python dictionaries, which is a useful thing to learn about.</p>
</section>
</section>
<section id="label-event-codes-mapping-between-dictionaries">
<h2>Label Event Codes – Mapping Between Dictionaries<a class="headerlink" href="#label-event-codes-mapping-between-dictionaries" title="Link to this heading">#</a></h2>
<div class="admonition-background-on-the-experiment-that-generated-these-data admonition">
<p class="admonition-title">Background on the Experiment that Generated These Data</p>
<p>This data set was collected while the participant viewed a series of pictures of objects on a computer screen. One second after each picture was presented, a spoken word was played over a speaker. The word was either the name of the pictured object, or some other word. Based on prior research, we predicted an <strong>N400</strong> ERP component for the mismatch trials relative to those on which the picture and word matched. In other words, the experimental contrast we are interested in is between <strong>Match</strong> and <strong>Mismatch</strong> trials.</p>
<p>The N400 is a component first discovered by <a class="reference external" href="https://dx.doi.org/10.1126/science.7350657">Kutas &amp; Hillyard (1980)</a>, in response to sentences that ended in a word whose meaning was not predicted given the preceding words in the sentence. For example, the sentence <em>I take my coffee with milk and dog.</em> would elicit an N400 at the word <em>dog</em>. More than 40 years of subsequent research has shown that the N400 is a marker of brain processes involved in integrating new information into an ongoing context that people maintain of words and concepts — or in technical terms, <em>semantic integration</em>. Violations of expectations related to the meaning of stimuli evoke an N400 response. In the present experiment, we did not use sentences, however each picture created a context and the subsequent word either fit (matched) or did not fit (mismatched) that context.</p>
<p>Although there were really only two experimental conditions in this experiment (match and mismatch), as you  there are a lot more than two event codes in the <code class="docutils literal notranslate"><span class="pre">events</span></code> array and <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> dictionary above! This is because in this study, the experimenters coded details of the stimuli in great detail. This is common in research, where we have one central research question, but perhaps other questions relating to more fine-grained details of the stimuli. As well, the stimuli may vary in ways that are not of experimental interest, but are properties that we would like to control for. For now we will label each event code.</p>
</div>
<p>We can define a dictionary that maps labels onto each (original) event code of interest:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PicOnset&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;RespPrompt&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;CorResp&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;IncorResp&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;RespFeedback&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;unused&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span>          
                 <span class="s1">&#39;Match/A&#39;</span><span class="p">:</span><span class="mi">111</span><span class="p">,</span> <span class="s1">&#39;Match/B&#39;</span><span class="p">:</span><span class="mi">211</span><span class="p">,</span> <span class="s1">&#39;Match/C&#39;</span><span class="p">:</span><span class="mi">112</span><span class="p">,</span> <span class="s1">&#39;Match/D&#39;</span><span class="p">:</span><span class="mi">212</span><span class="p">,</span>
                 <span class="s1">&#39;Mismatch/A&#39;</span><span class="p">:</span><span class="mi">101</span><span class="p">,</span> <span class="s1">&#39;Mismatch/B&#39;</span><span class="p">:</span><span class="mi">201</span><span class="p">,</span> <span class="s1">&#39;Mismatch/C&#39;</span><span class="p">:</span><span class="mi">102</span><span class="p">,</span> <span class="s1">&#39;Mismatch/D&#39;</span><span class="p">:</span><span class="mi">202</span>
                <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We now need to map between <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> and <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code>. The first thing we’ll do is swap the keys and values in <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code>, because once we extract the original, numerical event codes from <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> we will want to use them as keys to index into <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code> so that we can find the corresponding labels. We can do this with a dictionary comprehension (which is like list comprehension, but for dictionaries). <code class="docutils literal notranslate"><span class="pre">event_mapping.items()</span></code> will generate two outputs: the keys and the values of the dictionary. We can then swap them by putting the values first, and the keys second, separated by a colon. We then wrap this in curly braces to indicate that we are creating a dictionary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># swap keys and values in event_mapping</span>
<span class="n">event_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">event_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">event_mapping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;PicOnset&#39;,
 2: &#39;RespPrompt&#39;,
 3: &#39;CorResp&#39;,
 4: &#39;IncorResp&#39;,
 5: &#39;RespFeedback&#39;,
 7: &#39;unused&#39;,
 111: &#39;Match/A&#39;,
 211: &#39;Match/B&#39;,
 112: &#39;Match/C&#39;,
 212: &#39;Match/D&#39;,
 101: &#39;Mismatch/A&#39;,
 201: &#39;Mismatch/B&#39;,
 102: &#39;Mismatch/C&#39;,
 202: &#39;Mismatch/D&#39;}
</pre></div>
</div>
</div>
</div>
<p>The next thing we need to do is extract the numerical event codes from <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> (e.g., the<code class="docutils literal notranslate"><span class="pre">'1'</span></code> in <code class="docutils literal notranslate"><span class="pre">'Stimulus/S</span>&#160; <span class="pre">1':</span> <span class="pre">3</span></code>). We only need to do this for event codes that start with <code class="docutils literal notranslate"><span class="pre">'Stimulus/S</span></code>, so we can select only the keys in <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> that match this string, then strip it from each key to get the numerical event code. We can then use this numerical code to index into <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code> to get the label for that event code. We can then assign the label to the <code class="docutils literal notranslate"><span class="pre">name</span></code> key in <code class="docutils literal notranslate"><span class="pre">events_dict</span></code> for that event code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a new dictionary to map experiment labels to MNE&#39;s event codes</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">events_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># select only the keys in `events_dict` that match this string</span>
    <span class="k">if</span> <span class="s1">&#39;Stimulus/S&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="c1"># strip the leading text from the key to get the numerical event code</span>
        <span class="n">orig_event_code</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/S&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># &quot;value&quot; is the integer event code that MNE assigned to each event code it found in the data</span>
        <span class="c1"># we map this value to a key that corresponds to the original event code, </span>
        <span class="c1"># and add this key:value pair to event_id</span>
        <span class="n">event_id</span><span class="p">[</span><span class="n">event_mapping</span><span class="p">[</span><span class="n">orig_event_code</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
        
<span class="n">event_id</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;PicOnset&#39;: 3,
 &#39;RespPrompt&#39;: 4,
 &#39;CorResp&#39;: 5,
 &#39;IncorResp&#39;: 6,
 &#39;RespFeedback&#39;: 7,
 &#39;unused&#39;: 8,
 &#39;Mismatch/A&#39;: 9,
 &#39;Mismatch/C&#39;: 10,
 &#39;Match/A&#39;: 11,
 &#39;Match/C&#39;: 12,
 &#39;Mismatch/B&#39;: 13,
 &#39;Mismatch/D&#39;: 14,
 &#39;Match/B&#39;: 15,
 &#39;Match/D&#39;: 16}
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-events-over-time">
<h2>Plot Events Over Time<a class="headerlink" href="#plot-events-over-time" title="Link to this heading">#</a></h2>
<p>MNE provides a useful function, <code class="docutils literal notranslate"><span class="pre">mne.viz.plot_events()</span></code>, which will read an events array and plot the timing of event codes over the time, with different rows and colors for each event type. We have to pass the sampling rate (<code class="docutils literal notranslate"><span class="pre">raw.info['sfreq']</span></code>) as the second argument so that MNE knows how to convert the samples in the <code class="docutils literal notranslate"><span class="pre">events</span></code> array to units of time. We also pass the mapping between labels and event codes (<code class="docutils literal notranslate"><span class="pre">event_id</span></code>) so that the plot has a meaningful legend.</p>
<p>This plot can be very useful to understand the timeline of an experiment, and also to confirm that the types and timing of event codes Control what was expected based on the design of the experiment. In the present experiment, all three sentence types were randomly intermixed, so the plot below is consistent with this.</p>
<p>Note that it’s not necessary to use <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> before running any MNE plot routine. However, in some cases, such as this one, MNE’s default plot size is not optimal for what is being plotted, so <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> allows us to specify the figure size. Note that when we run the MNE plot command, we don’t apply a Matplotlib axis method, but instead pass the <code class="docutils literal notranslate"><span class="pre">ax</span></code> pointer to the subplot to MNE’s plot command using the <code class="docutils literal notranslate"><span class="pre">axes=</span></code> kwarg. Many of MNE’s plotting commands support this kwarg, but not all (since some MNE plots actually create figures with multiple subplots).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">raw_filt</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span>  
                    <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span>                    
                    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f7f5956274fb43dffbd7de12cba75ce720ac061ce565e5cb224c272c15317928.png" src="../_images/f7f5956274fb43dffbd7de12cba75ce720ac061ce565e5cb224c272c15317928.png" />
</div>
</div>
<p>This plot of event codes over time can be very useful in ensuring that the event codes in your experiment occurred as expected. This is especially important to check when you’re first pilot-testing an experiment, before you collect data from lots of participants. It’s also useful simply to visualize and understand the structure of an experiment.</p>
<p>For example, in the plot above the bottom three rows show lots of dots (event codes) quite regularly over the duration of the data collection. The legend tells us these correspond to picture onsets, response prompts, and correct responses. This makes sense since pictures appeared on every trial, and the participant was prompted for a response on every trial. And, participants performed the task reasonably well, so the majority of responses were correct; we can see a few incorrect responses along the line marked <code class="docutils literal notranslate"><span class="pre">4</span></code> on the <em>y</em> axis. The other event codes occur less frequently, and at somewhat random intervals – these are the individual match and mismatch trials, whose order was randomized in the experiment. However, if you look closely you can see that the experiment was broken into two blocks: the <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> trial types occurred in the first half of the experiment, while the <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">D</span></code> trial types occurred in the second half.</p>
</section>
<section id="segment-the-data-into-epochs">
<h2>Segment the data into epochs<a class="headerlink" href="#segment-the-data-into-epochs" title="Link to this heading">#</a></h2>
<p>Having extracted our event codes, and mapped them to labels, we are now ready to split the continuous, filtered raw EEG data into epochs time-locked to the event codes of interest, as defined in the <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code> dictionary we created above. To do this we use <code class="docutils literal notranslate"><span class="pre">mne.Epochs()</span></code>, which creates an object of the class <code class="docutils literal notranslate"><span class="pre">Epochs</span></code>. The <a class="reference external" href="https://mne.tools/stable/generated/mne.Epochs.html">API</a> for this function is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mne.Epochs(raw, events, event_id=None, tmin=-0.2, tmax=0.5, baseline=(None, 0), picks=None, preload=False, reject=None, flat=None, proj=True, decim=1, reject_tmin=None, reject_tmax=None, detrend=None, on_missing=&#39;raise&#39;, reject_by_annotation=True, metadata=None, event_repeated=&#39;error&#39;, verbose=None)
</pre></div>
</div>
<p>We don’t need to specify all of the arguments listed in the API, but a number of them are necessary; the first 5 of these are <em>positional</em> arguments, meaning that the first 5 arguments positions are required, must occur in the order shown, and must have specific contents:</p>
<ul class="simple">
<li><p>the first is the raw data. We will pass the filtered raw data.</p></li>
<li><p>the next two arguments are the events array, and the mapping of events to labels (we’ll use <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code>)</p></li>
<li><p>the fourth and fifth arguments are the start and end times of each epoch (<code class="docutils literal notranslate"><span class="pre">timn</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code>), relative to the event code. Typically the minimum (start) time is a negative number, because for reasons explained below we want a <em>baseline</em> period to compare to the activity after the event code (typically 50-200 ms, but sometimes longer). The end time depends on the timing of the ERP components you expect to occur. Some types of stimuli and experiments (such as studies of attention, or face processing) may only be interested in ERPs that occur within, say, the first 500 ms after stimulus presentation. In language studies, interesting effects often occur up to 1 s or even longer after a word is presented. An important thing to note is that  times in MNE are always specified in <em>seconds</em> (which is a bit counter-intuitive because we commonly talk about the timing of ERPs in milliseconds).</p></li>
</ul>
<p>After these 5 required positional arguments, there are many kwargs we can specify. For our purposes, the defaults for most of these are fine. However, we will specify two additional kwargs:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">baseline</span></code> kwarg specifies what time period to use as the baseline for each epoch. The baseline is the period before the stimulus onset, and it is used to define “zero” voltage for each trial. This is necessary because the measured electrical potentials can drift quite a lot over the course of the experiment (even after we filter out the lowest-frequency drift), and artifacts can affect absolute microVolt values as well. So the absolute microVolt values for any given epoch might be rather different from other epochs, due to drift. By subtracting the mean amplitude over the baseline period from each trial (and for each channel), we “center” the measurements for that trial such that the potentials after the onset of each event code reflect the deviations of our measurements from the baseline period. Put another way, the measurements of each epoch reflect any changes in electrical potential that occur after the event code, relative to the baseline period before it. We use <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">0)</span></code> for the baseline to specify the time period from the start of the epoch to the time of the event code.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Subtracting the baseline like this is not always necessary, or desirable. Another approach is to leave the baseline untouched at the epoching stage, and worry about it later. In particular, there is an approach called <em>baseline regression</em> (<a href="https://onlinelibrary.wiley.com/doi/10.1111/psyp.13451">Alday, 2019</a>) in which the mean amplitude of the baseline on each trial is used as a predictor in a regression model, which allows one to “regress out” the baseline on a trial-by-trial basis rather than subtracting it. This can be particularly useful in certain cases, such as when the baseline period isn’t actually “silent” but contains some activity of interest (e.g., a previous word when reading a sentence or listening to a story; see e.g., <a href="https://dx.doi.org/10.3389/fpsyg.2022.668276">Sayehli et al., 2022</a>). However, the standard baseline subtraction approach is valid in most cases and we will use it here.</p>
</div>
<p>To make these important parameter choices easy to find and modify in our code, we will assign each value to a variable name, and in <code class="docutils literal notranslate"><span class="pre">mne.Epochs</span></code> we’ll use those variables.</p>
<p>We also include the <code class="docutils literal notranslate"><span class="pre">preload=True</span></code> kwarg. As with <code class="docutils literal notranslate"><span class="pre">raw</span></code> data, MNE tries to save memory by not keeping the epoched data in memory unless it is needed. However, below we will need it and so we force MNE to store this in the data here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Epoching settings</span>
<span class="n">tmin</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">.100</span>  <span class="c1"># start of each epoch (in sec)</span>
<span class="n">tmax</span> <span class="o">=</span>  <span class="mf">1.000</span>  <span class="c1"># end of each epoch (in sec)</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create epochs</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw_filt</span><span class="p">,</span>
                    <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span>
                    <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span>
                    <span class="n">baseline</span><span class="o">=</span><span class="n">baseline</span><span class="p">,</span> 
                    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span>
                   <span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="viewing-and-indexing-epochs">
<h2>Viewing and Indexing Epochs<a class="headerlink" href="#viewing-and-indexing-epochs" title="Link to this heading">#</a></h2>
<p>If we ask for the value of <code class="docutils literal notranslate"><span class="pre">epochs</span></code> we get nice, tidy output with a summary of the contents of the data structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-69299c76-36e0-4e71-a717-c49a173a926d"  title="Hide section" 
    onclick="toggleVisibility('general-69299c76-36e0-4e71-a717-c49a173a926d')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-69299c76-36e0-4e71-a717-c49a173a926d ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-69299c76-36e0-4e71-a717-c49a173a926d ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-69299c76-36e0-4e71-a717-c49a173a926d ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-69299c76-36e0-4e71-a717-c49a173a926d ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac" 
    title="Hide section"  onclick="toggleVisibility('acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>531</td>
</tr>


<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        CorResp: 144
        <br />
        
        IncorResp: 1
        <br />
        
        Match/A: 18
        <br />
        
        Match/B: 18
        <br />
        
        Match/C: 18
        <br />
        
        Match/D: 18
        <br />
        
        Mismatch/A: 18
        <br />
        
        Mismatch/B: 18
        <br />
        
        Mismatch/C: 18
        <br />
        
        Mismatch/D: 18
        <br />
        
        PicOnset: 144
        <br />
        
        RespFeedback: 1
        <br />
        
        RespPrompt: 96
        <br />
        
        unused: 1
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-e769fc4e-f394-4bc0-acd4-1d92c1e8e8ac ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-89a8c44a-2bea-4c74-b417-0a9f89306b24"  title="Hide section" 
    onclick="toggleVisibility('channels-89a8c44a-2bea-4c74-b417-0a9f89306b24')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-89a8c44a-2bea-4c74-b417-0a9f89306b24 ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-89a8c44a-2bea-4c74-b417-0a9f89306b24 ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-cbe3b19d-b2a7-4cee-9c83-5df72c5ac717"  title="Hide section" 
    onclick="toggleVisibility('filters-cbe3b19d-b2a7-4cee-9c83-5df72c5ac717')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-cbe3b19d-b2a7-4cee-9c83-5df72c5ac717 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-cbe3b19d-b2a7-4cee-9c83-5df72c5ac717 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<p>Epochs can be accessed in a variety of ways, all using square brackets <code class="docutils literal notranslate"><span class="pre">epochs[]</span></code>.</p>
<p>If we use an integer, we get the epoch at that index position (epochs are numbered from zero to the total number of epochs, in the order that the event codes occurred in the raw data):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-e28aefbe-69c4-4ebc-8bea-f9e050fc192b"  title="Hide section" 
    onclick="toggleVisibility('general-e28aefbe-69c4-4ebc-8bea-f9e050fc192b')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-e28aefbe-69c4-4ebc-8bea-f9e050fc192b ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-e28aefbe-69c4-4ebc-8bea-f9e050fc192b ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-e28aefbe-69c4-4ebc-8bea-f9e050fc192b ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-e28aefbe-69c4-4ebc-8bea-f9e050fc192b ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596" 
    title="Hide section"  onclick="toggleVisibility('acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>1</td>
</tr>


<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        RespFeedback: 1
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-b0c46c38-85d3-4df0-9857-8d4c2195b596 ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-679b5f19-2d7a-4334-adde-08723707da00"  title="Hide section" 
    onclick="toggleVisibility('channels-679b5f19-2d7a-4334-adde-08723707da00')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-679b5f19-2d7a-4334-adde-08723707da00 ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-679b5f19-2d7a-4334-adde-08723707da00 ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-73252a04-e773-4f30-9a94-84c28d6468c0"  title="Hide section" 
    onclick="toggleVisibility('filters-73252a04-e773-4f30-9a94-84c28d6468c0')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-73252a04-e773-4f30-9a94-84c28d6468c0 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-73252a04-e773-4f30-9a94-84c28d6468c0 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-30556a74-73e1-48c3-939a-114440bed49f"  title="Hide section" 
    onclick="toggleVisibility('general-30556a74-73e1-48c3-939a-114440bed49f')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-30556a74-73e1-48c3-939a-114440bed49f ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-30556a74-73e1-48c3-939a-114440bed49f ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-30556a74-73e1-48c3-939a-114440bed49f ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-30556a74-73e1-48c3-939a-114440bed49f ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255" 
    title="Hide section"  onclick="toggleVisibility('acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>5</td>
</tr>


<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        CorResp: 2
        <br />
        
        Match/A: 1
        <br />
        
        PicOnset: 1
        <br />
        
        RespPrompt: 1
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-6aeaf8d8-31d6-4941-94f1-2015fafee255 ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-865e6755-8d83-45d6-98a1-d016c7df4dd2"  title="Hide section" 
    onclick="toggleVisibility('channels-865e6755-8d83-45d6-98a1-d016c7df4dd2')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-865e6755-8d83-45d6-98a1-d016c7df4dd2 ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-865e6755-8d83-45d6-98a1-d016c7df4dd2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-86aba956-a37d-46f9-bd45-96bc0b178846"  title="Hide section" 
    onclick="toggleVisibility('filters-86aba956-a37d-46f9-bd45-96bc0b178846')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-86aba956-a37d-46f9-bd45-96bc0b178846 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-86aba956-a37d-46f9-bd45-96bc0b178846 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<p>Alternatively, we can access all of the epochs associated with a particular event code, using the label we assigned to the code using <code class="docutils literal notranslate"><span class="pre">event_mapping</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match/A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-8babefe2-4449-4649-918c-e09220b4987d"  title="Hide section" 
    onclick="toggleVisibility('general-8babefe2-4449-4649-918c-e09220b4987d')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-8babefe2-4449-4649-918c-e09220b4987d ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-8babefe2-4449-4649-918c-e09220b4987d ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-8babefe2-4449-4649-918c-e09220b4987d ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-8babefe2-4449-4649-918c-e09220b4987d ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-908a9890-330e-42d3-879e-f2596515d91c" 
    title="Hide section"  onclick="toggleVisibility('acquisition-908a9890-330e-42d3-879e-f2596515d91c')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>18</td>
</tr>


<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        Match/A: 18
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-908a9890-330e-42d3-879e-f2596515d91c ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-6b891dc2-3624-47c8-b1a5-79b6946cff45"  title="Hide section" 
    onclick="toggleVisibility('channels-6b891dc2-3624-47c8-b1a5-79b6946cff45')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-6b891dc2-3624-47c8-b1a5-79b6946cff45 ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-6b891dc2-3624-47c8-b1a5-79b6946cff45 ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-df13b347-a8e1-4cb3-8706-c2ea5cbcf2b2"  title="Hide section" 
    onclick="toggleVisibility('filters-df13b347-a8e1-4cb3-8706-c2ea5cbcf2b2')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-df13b347-a8e1-4cb3-8706-c2ea5cbcf2b2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-df13b347-a8e1-4cb3-8706-c2ea5cbcf2b2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<p>These two methods can be combined to select a specific event out of those in a condition:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match/A&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-84dec907-ed6d-4556-be0b-fe6739594b2f"  title="Hide section" 
    onclick="toggleVisibility('general-84dec907-ed6d-4556-be0b-fe6739594b2f')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-84dec907-ed6d-4556-be0b-fe6739594b2f ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-84dec907-ed6d-4556-be0b-fe6739594b2f ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-84dec907-ed6d-4556-be0b-fe6739594b2f ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-84dec907-ed6d-4556-be0b-fe6739594b2f ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-28a567d9-4843-4402-900f-0602b95508be" 
    title="Hide section"  onclick="toggleVisibility('acquisition-28a567d9-4843-4402-900f-0602b95508be')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>1</td>
</tr>


<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        Match/A: 1
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-28a567d9-4843-4402-900f-0602b95508be ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-39a68b25-28c9-4883-9614-e9e93c3e782c"  title="Hide section" 
    onclick="toggleVisibility('channels-39a68b25-28c9-4883-9614-e9e93c3e782c')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-39a68b25-28c9-4883-9614-e9e93c3e782c ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-39a68b25-28c9-4883-9614-e9e93c3e782c ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-bb28070e-771c-433a-8419-e59b1606acb4"  title="Hide section" 
    onclick="toggleVisibility('filters-bb28070e-771c-433a-8419-e59b1606acb4')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-bb28070e-771c-433a-8419-e59b1606acb4 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-bb28070e-771c-433a-8419-e59b1606acb4 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<p>If we pass multiple condition labels, then we will get all epochs in each of the conditions specified:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match/A&#39;</span><span class="p">,</span> <span class="s1">&#39;Match/B&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-a9250fe0-6622-4f8e-b9dc-2ed2bd21c8ee"  title="Hide section" 
    onclick="toggleVisibility('general-a9250fe0-6622-4f8e-b9dc-2ed2bd21c8ee')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-a9250fe0-6622-4f8e-b9dc-2ed2bd21c8ee ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-a9250fe0-6622-4f8e-b9dc-2ed2bd21c8ee ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-a9250fe0-6622-4f8e-b9dc-2ed2bd21c8ee ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-a9250fe0-6622-4f8e-b9dc-2ed2bd21c8ee ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe" 
    title="Hide section"  onclick="toggleVisibility('acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>36</td>
</tr>


<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        Match/A: 18
        <br />
        
        Match/B: 18
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-f718de14-d58a-47fa-83c0-6283d8dc68fe ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-f835d28b-157b-46c8-ac80-e082a44fd0fb"  title="Hide section" 
    onclick="toggleVisibility('channels-f835d28b-157b-46c8-ac80-e082a44fd0fb')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-f835d28b-157b-46c8-ac80-e082a44fd0fb ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-f835d28b-157b-46c8-ac80-e082a44fd0fb ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-e0ccf08e-035f-4b18-a6e4-1f145be925fd"  title="Hide section" 
    onclick="toggleVisibility('filters-e0ccf08e-035f-4b18-a6e4-1f145be925fd')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-e0ccf08e-035f-4b18-a6e4-1f145be925fd ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-e0ccf08e-035f-4b18-a6e4-1f145be925fd ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<p>MNE also recognizes the <code class="docutils literal notranslate"><span class="pre">/</span></code> separator for condition labels (e.g., in <code class="docutils literal notranslate"><span class="pre">'Match/A'</span></code>): the string before the <code class="docutils literal notranslate"><span class="pre">/</span></code> is treated as a more general category, with the string after the <code class="docutils literal notranslate"><span class="pre">/</span></code> treated as subsets of that category. So we can see all of the Match trials (<code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, &amp; <code class="docutils literal notranslate"><span class="pre">D</span></code>) by passing <code class="docutils literal notranslate"><span class="pre">'Match'</span></code> as the condition label:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-2ad2360a-cef8-41f7-a667-09a7c216e58a"  title="Hide section" 
    onclick="toggleVisibility('general-2ad2360a-cef8-41f7-a667-09a7c216e58a')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-2ad2360a-cef8-41f7-a667-09a7c216e58a ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-2ad2360a-cef8-41f7-a667-09a7c216e58a ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-2ad2360a-cef8-41f7-a667-09a7c216e58a ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-2ad2360a-cef8-41f7-a667-09a7c216e58a ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-473f0056-10c0-4866-ba58-93540017e3f3" 
    title="Hide section"  onclick="toggleVisibility('acquisition-473f0056-10c0-4866-ba58-93540017e3f3')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>72</td>
</tr>


<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        Match/A: 18
        <br />
        
        Match/B: 18
        <br />
        
        Match/C: 18
        <br />
        
        Match/D: 18
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-473f0056-10c0-4866-ba58-93540017e3f3 ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-de721fe5-36ea-4d3e-b505-c65220ef6924"  title="Hide section" 
    onclick="toggleVisibility('channels-de721fe5-36ea-4d3e-b505-c65220ef6924')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-de721fe5-36ea-4d3e-b505-c65220ef6924 ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-de721fe5-36ea-4d3e-b505-c65220ef6924 ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-40218f65-37bc-4a19-81c3-91f4c4892bbc"  title="Hide section" 
    onclick="toggleVisibility('filters-40218f65-37bc-4a19-81c3-91f4c4892bbc')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-40218f65-37bc-4a19-81c3-91f4c4892bbc ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-40218f65-37bc-4a19-81c3-91f4c4892bbc ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<p>Likewise, we can see all of the epochs in the <code class="docutils literal notranslate"><span class="pre">A</span></code> condition (<code class="docutils literal notranslate"><span class="pre">Match</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">Mismatch</span></code>) by passing <code class="docutils literal notranslate"><span class="pre">'A'</span></code> as the condition label:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-49acb6ef-9578-4d20-9d2e-bb623d9009a1"  title="Hide section" 
    onclick="toggleVisibility('general-49acb6ef-9578-4d20-9d2e-bb623d9009a1')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-49acb6ef-9578-4d20-9d2e-bb623d9009a1 ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-49acb6ef-9578-4d20-9d2e-bb623d9009a1 ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-49acb6ef-9578-4d20-9d2e-bb623d9009a1 ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-49acb6ef-9578-4d20-9d2e-bb623d9009a1 ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2" 
    title="Hide section"  onclick="toggleVisibility('acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>36</td>
</tr>


<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        Match/A: 18
        <br />
        
        Mismatch/A: 18
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-c0cc5242-8556-49ed-b6eb-6033fe83f3e2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-bda73857-8e35-4fb5-8a6c-9a3f69c9378f"  title="Hide section" 
    onclick="toggleVisibility('channels-bda73857-8e35-4fb5-8a6c-9a3f69c9378f')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-bda73857-8e35-4fb5-8a6c-9a3f69c9378f ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-bda73857-8e35-4fb5-8a6c-9a3f69c9378f ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-4e914c5b-e77b-4205-941d-c5724c9beb85"  title="Hide section" 
    onclick="toggleVisibility('filters-4e914c5b-e77b-4205-941d-c5724c9beb85')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-4e914c5b-e77b-4205-941d-c5724c9beb85 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-4e914c5b-e77b-4205-941d-c5724c9beb85 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
</section>
<section id="visualize-average-erp-across-conditions-of-interest-before-artifact-correction">
<h2>Visualize Average ERP Across Conditions of Interest – Before Artifact Correction<a class="headerlink" href="#visualize-average-erp-across-conditions-of-interest-before-artifact-correction" title="Link to this heading">#</a></h2>
<p>While it’s useful to see the summary of the epochs object, it’s more interesting to visualize the data. The <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> class has a <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method to do this. Since <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> contains each individual trial, if we try to plot multiple epochs (e.g., <code class="docutils literal notranslate"><span class="pre">epochs.plot()</span></code>) we will get an interactive plot (like we saw previously for scrolling through the raw data). Typically what we want to see is the <em>average</em> across all trials of a condition. This is central to ERPs — the data on each individual trial is noisy, but when we average across many trials, the noise tends to cancel out, leaving the ERP component of interest. So we need to chain the <code class="docutils literal notranslate"><span class="pre">.average()</span></code> method with <code class="docutils literal notranslate"><span class="pre">.plot()</span></code>. Here we’ll average across Match and Mismatch epochs; even though ultimately we want to compare these two, for the purposes of assessing data quality we’ll average them together:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span> <span class="c1"># remember the semicolon prevents a duplicated plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/159c67f6c4dca35805ebd7ef9d144555d543f8bce90c8d6458d3f0c9539b24f4.png" src="../_images/159c67f6c4dca35805ebd7ef9d144555d543f8bce90c8d6458d3f0c9539b24f4.png" />
</div>
</div>
<p>The above <em>butterfly plot</em> shows all electrodes on a single axis. The color of the lines indicates where ont he head the channel was located, as shown in the inset head plot.</p>
<body textcolor="red">
<em>No longer true:</em>
The above plot shows strong evidence of ocular artifacts in the data: the amplitude scale is on the order of 100 µV, whereas real EEG is rarely more than 10–20 µV, and the largest amplitude values are in channels around the eyes (you can tell this by matching the colors of the lines in the plot with those of the channel locations on the inset showing the electrode layout). Remember that we created these epochs from the filtered raw data, from which we have not yet removed artifacts. 
</body><div class="admonition-butterflies-and-rainbows admonition">
<p class="admonition-title">Butterflies and Rainbows</p>
<p>Plotting all electrodes on one axis is called a <strong>butterfly plot</strong>. The name may seem strange but when you use it to plot data from lots of sensors (especially MEG data), it does look somewhat like a butterfly:</p>
<p><img alt="butterfly plot of MEG data containing 245 channels" src="https://mne.tools/dev/_images/sphx_glr_90_phantom_4DBTi_001.png" />.</p>
</div>
</section>
<section id="apply-ica-correction-to-epochs">
<h2>Apply ICA correction to epochs<a class="headerlink" href="#apply-ica-correction-to-epochs" title="Link to this heading">#</a></h2>
<p>Recall that in the previous lesson, we created <code class="docutils literal notranslate"><span class="pre">epochs_ica</span></code>, with 1 s segments of the entire raw file, which we fit ICA on to identify artifacts. We then saved the indices of the ICs to <code class="docutils literal notranslate"><span class="pre">ica.exclude</span></code>, and saved the ICA decomposition to a file. Here, we can load that file and apply the ICA decomposition – and the exclusion of ICs – to the <code class="docutils literal notranslate"><span class="pre">epochs</span></code> data that we just created in the present lesson — i.e., the ERP data time-locked to events of interest. This works because what is stored in the <code class="docutils literal notranslate"><span class="pre">ica</span></code> object is not the original data that ICA was applied to, but a formula for applying a mathematical transformation to data. So we can apply that same transformation to any data that has the same number of channels as the original data.</p>
<p>As with many MNE methods (such as filtering, as we saw earlier), the <code class="docutils literal notranslate"><span class="pre">ICA</span></code> <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method operates on data in-place, meaning it alters the data that is passed to it. In general, it’s good practice to make copies of data when applying transformations (this is especially useful when developing your own code, in case what you try doesn’t work the first time. It’s nice not to have to redo preivous steps to re-create your Epochs). So here we use the <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the previously-saved ICA decomposition</span>
<span class="n">ica</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">read_ica</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="n">p_id</span> <span class="o">+</span> <span class="s1">&#39;-ica.fif&#39;</span><span class="p">)</span>

<span class="c1"># apply the ICA decomposition (excluding the marked ICs) to the epochs</span>
<span class="n">epochs_postica</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<section id="visualize-average-erp-after-ica-artifact-removal">
<h3>Visualize Average ERP After ICA Artifact Removal<a class="headerlink" href="#visualize-average-erp-after-ica-artifact-removal" title="Link to this heading">#</a></h3>
<p>Let’s create a figure with two subplots to visualize the butterfly plots before and after ICA correction. THe differences between the two seem to start around 200 ms. In general, the artifact-corrected data shows less variance across channels. This is an effect of removing ocular artifacts — blinks and eye movememnts are very large at the frontal channels and comparatively small at posterior channels — meaning the variance, or overall difference between channels, is large. Removing those artifacts reduces the variance across channels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="c1"># remember the semicolon prevents a duplicated plot</span>
<span class="n">epochs_postica</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="c1"># remember the semicolon prevents a duplicated plot</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">epochs_postica</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span>

<span class="nn">File ~/miniforge3/envs/neural_data_science/lib/python3.12/site-packages/mne/evoked.py:509,</span> in <span class="ni">Evoked.plot</span><span class="nt">(self, picks, exclude, unit, show, ylim, xlim, proj, hline, units, scalings, titles, axes, gfp, window_title, spatial_colors, zorder, selectable, noise_cov, time_unit, sphere, highlight, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">482</span> <span class="nd">@copy_function_doc_to_method_doc</span><span class="p">(</span><span class="n">plot_evoked</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span> <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">484</span>     <span class="bp">self</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span>     <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span> <span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">509</span>     <span class="k">return</span> <span class="n">plot_evoked</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>         <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>         <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">512</span>         <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span>         <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">514</span>         <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">515</span>         <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">516</span>         <span class="n">proj</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">517</span>         <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">518</span>         <span class="n">hline</span><span class="o">=</span><span class="n">hline</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">519</span>         <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">520</span>         <span class="n">scalings</span><span class="o">=</span><span class="n">scalings</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">521</span>         <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">522</span>         <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">523</span>         <span class="n">gfp</span><span class="o">=</span><span class="n">gfp</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">524</span>         <span class="n">window_title</span><span class="o">=</span><span class="n">window_title</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">525</span>         <span class="n">spatial_colors</span><span class="o">=</span><span class="n">spatial_colors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">526</span>         <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">527</span>         <span class="n">selectable</span><span class="o">=</span><span class="n">selectable</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">528</span>         <span class="n">noise_cov</span><span class="o">=</span><span class="n">noise_cov</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span>         <span class="n">time_unit</span><span class="o">=</span><span class="n">time_unit</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">530</span>         <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">531</span>         <span class="n">highlight</span><span class="o">=</span><span class="n">highlight</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span>         <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span>     <span class="p">)</span>

<span class="nn">File &lt;decorator-gen-215&gt;:12,</span> in <span class="ni">plot_evoked</span><span class="nt">(evoked, picks, exclude, unit, show, ylim, xlim, proj, hline, units, scalings, titles, axes, gfp, window_title, spatial_colors, zorder, selectable, noise_cov, time_unit, sphere, highlight, verbose)</span>

<span class="nn">File ~/miniforge3/envs/neural_data_science/lib/python3.12/site-packages/mne/viz/evoked.py:1108,</span> in <span class="ni">plot_evoked</span><span class="nt">(evoked, picks, exclude, unit, show, ylim, xlim, proj, hline, units, scalings, titles, axes, gfp, window_title, spatial_colors, zorder, selectable, noise_cov, time_unit, sphere, highlight, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">962</span> <span class="nd">@verbose</span>
<span class="g g-Whitespace">    </span><span class="mi">963</span> <span class="k">def</span> <span class="nf">plot_evoked</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">964</span>     <span class="n">evoked</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">987</span>     <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">988</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">989</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Plot evoked data using butterfly plots.</span>
<span class="g g-Whitespace">    </span><span class="mi">990</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">991</span><span class="sd">     Left click to a line shows the channel name. Selecting an area by clicking</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1106</span><span class="sd">     mne.viz.plot_evoked_white</span>
<span class="g g-Whitespace">   </span><span class="mi">1107</span><span class="sd">     &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
<span class="ne">-&gt; </span><span class="mi">1108</span>     <span class="k">return</span> <span class="n">_plot_evoked</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1109</span>         <span class="n">evoked</span><span class="o">=</span><span class="n">evoked</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1110</span>         <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1111</span>         <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1112</span>         <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1113</span>         <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1114</span>         <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1115</span>         <span class="n">proj</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1116</span>         <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1117</span>         <span class="n">hline</span><span class="o">=</span><span class="n">hline</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1118</span>         <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1119</span>         <span class="n">scalings</span><span class="o">=</span><span class="n">scalings</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1120</span>         <span class="n">titles</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1121</span>         <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1122</span>         <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;butterfly&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1123</span>         <span class="n">gfp</span><span class="o">=</span><span class="n">gfp</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1124</span>         <span class="n">window_title</span><span class="o">=</span><span class="n">window_title</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1125</span>         <span class="n">spatial_colors</span><span class="o">=</span><span class="n">spatial_colors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1126</span>         <span class="n">selectable</span><span class="o">=</span><span class="n">selectable</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1127</span>         <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1128</span>         <span class="n">noise_cov</span><span class="o">=</span><span class="n">noise_cov</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1129</span>         <span class="n">time_unit</span><span class="o">=</span><span class="n">time_unit</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1130</span>         <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1131</span>         <span class="n">highlight</span><span class="o">=</span><span class="n">highlight</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1132</span>     <span class="p">)</span>

<span class="nn">File ~/miniforge3/envs/neural_data_science/lib/python3.12/site-packages/mne/viz/evoked.py:425,</span> in <span class="ni">_plot_evoked</span><span class="nt">(evoked, picks, exclude, unit, show, ylim, proj, xlim, hline, units, scalings, titles, axes, plot_type, cmap, gfp, window_title, spatial_colors, selectable, zorder, noise_cov, colorbar, mask, mask_style, mask_cmap, mask_alpha, time_unit, show_names, group_by, sphere, highlight, draw)</span>
<span class="g g-Whitespace">    </span><span class="mi">423</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`clim` must be a dict. E.g. clim = dict(eeg=[-20, 20])&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">424</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">425</span>     <span class="n">_validate_type</span><span class="p">(</span><span class="n">ylim</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="s2">&quot;ylim&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span> <span class="n">picks</span> <span class="o">=</span> <span class="n">_picks_to_idx</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">picks</span><span class="p">,</span> <span class="n">none</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">428</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">picks</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">picks</span><span class="p">)):</span>

<span class="nn">File ~/miniforge3/envs/neural_data_science/lib/python3.12/site-packages/mne/utils/check.py:614,</span> in <span class="ni">_validate_type</span><span class="nt">(item, types, item_name, type_name, extra)</span>
<span class="g g-Whitespace">    </span><span class="mi">612</span>         <span class="n">type_name</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">type_name</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">613</span> <span class="n">_item_name</span> <span class="o">=</span> <span class="s2">&quot;Item&quot;</span> <span class="k">if</span> <span class="n">item_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">item_name</span>
<span class="ne">--&gt; </span><span class="mi">614</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">615</span>     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_item_name</span><span class="si">}</span><span class="s2"> must be an instance of </span><span class="si">{</span><span class="n">type_name</span><span class="si">}{</span><span class="n">extra</span><span class="si">}</span><span class="s2">, &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span>     <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="p">)</span>

<span class="ne">TypeError</span>: ylim must be an instance of dict or None, got &lt;class &#39;list&#39;&gt; instead.
</pre></div>
</div>
<img alt="../_images/cb5f39e6352561e3986efa9be79827ab187befdaaebd22afbde1762f116fcb5e.png" src="../_images/cb5f39e6352561e3986efa9be79827ab187befdaaebd22afbde1762f116fcb5e.png" />
</div>
</div>
</section>
</section>
<section id="autoreject-for-final-data-cleaning">
<h2>AutoReject for Final Data Cleaning<a class="headerlink" href="#autoreject-for-final-data-cleaning" title="Link to this heading">#</a></h2>
<p>ICA correction removed the ocular (blink and eye movement) artifacts. However, there are potentially other sources of noise remaining in the data, including muscle noise, “paroxysmal” artifacts (sudden, large-amplitude deflections), and other sources. Sometimes as well, individual channels contain noise either over the entire recording, or in specific segments. We can use the AutoReject algorithm to automatically detect and remove bad epochs and channels. Any channels that are removed are then replaced using interpolation – essentially averaging the data from surrounding channels to estimate the data from the noisy channel.</p>
<p>You may recall that we used AutoReject earlier, prior to running ICA. At that point, we used AutoReject to identify and exclude any particularly noisy segments of data from the ICA decomposition. But we didn’t actually remove those segments from the data set, we just told ICA to ignore them. Here, we will use AutoReject to identify <em>and</em> exclude any particularly noisy epochs, and correct noisy channels through interpolation.</p>
<p>Here we run the same code we used prior to ICA, except that we fit it to the <code class="docutils literal notranslate"><span class="pre">epochs_clean</span></code> data that has been cleaned with ICA. Another difference is that previously, we used the <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> method to fit the AutoReject algorithm to the data, and then used the information stored in the fit to exclude noisy epochs from ICA. Here instead, we apply the <code class="docutils literal notranslate"><span class="pre">fit_transform()</span></code> method, which both fits the model, and <em>applies</em> the “transformation” (i.e., the exclusion of bad epochs and interpolation of bad channels) to the data. We include a kwarg asking the method to output a log of the steps that AutoReject took to clean the data. We can use this log to see what AutoReject did. We assign the output of this method to two variables, <code class="docutils literal notranslate"><span class="pre">epochs_clean</span></code> and <code class="docutils literal notranslate"><span class="pre">reject_log_clean</span></code>. The first is the cleaned data, and the second is the log.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Remember that AutoReject can take a long time to run. Just be patient and let it run. You’ll know when it’s done because you’ll see a description of the cleaned epochs printed below.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <span class="n">AutoReject</span>

<span class="n">ar</span> <span class="o">=</span> <span class="n">AutoReject</span><span class="p">(</span><span class="n">n_interpolate</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
                <span class="n">picks</span><span class="o">=</span><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">epochs_postica</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> 
                                     <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">eog</span><span class="o">=</span><span class="kc">False</span>
                                    <span class="p">),</span>
                <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>

<span class="n">epochs_clean</span><span class="p">,</span> <span class="n">reject_log_clean</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">epochs_postica</span><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">epochs_clean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    const toggleVisibility = (className) => {

  const elements = document.querySelectorAll(`.${className}`)

  elements.forEach(element => {
    if (element.classList.contains('repr-section-header')) {
      // Don't collapse the section header row.
       return
    }
    if (element.classList.contains('repr-element-collapsed')) {
      // Force a reflow to ensure the display change takes effect before removing the class
      element.classList.remove('repr-element-collapsed')
      element.offsetHeight // This forces the browser to recalculate layout
      element.classList.remove('repr-element-faded')
    } else {
      // Start transition to hide the element
      element.classList.add('repr-element-faded')
      element.addEventListener('transitionend', handler = (e) => {
        if (e.propertyName === 'opacity' && getComputedStyle(element).opacity === '0.2') {
          element.classList.add('repr-element-collapsed')
          element.removeEventListener('transitionend', handler)
        }
      });
    }
  });

  // Take care of button (adjust caret)
  const button = document.querySelectorAll(`.repr-section-header.${className} > th.repr-section-toggle-col > button`)[0]
  button.classList.toggle('collapsed')

  // Take care of the tooltip of the section header row
  const sectionHeaderRow = document.querySelectorAll(`tr.repr-section-header.${className}`)[0]
  sectionHeaderRow.classList.toggle('collapsed')
  sectionHeaderRow.title = sectionHeaderRow.title === 'Hide section' ? 'Show section' : 'Hide section'
}
</script>

<style type="text/css">
    table.repr.table.table-hover.table-striped.table-sm.table-responsive.small {
  /* Don't make rows wider than they need to be. */
  display: inline;
}

table > tbody > tr.repr-element > td {
  /* Apply a tighter layout to the table cells. */
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-right: 1rem;
}

table > tbody > tr > td.repr-section-toggle-col {
  /* Remove background and border of the first cell in every row
     (this row is only used for the collapse / uncollapse caret)

     TODO: Need to find a good solution for VS Code that works in both
           light and dark mode. */
  border-color: transparent;
  --bs-table-accent-bg: transparent;
}

tr.repr-section-header {
  /* Remove stripes from section header rows */
  background-color: transparent;
  border-color: transparent;
  --bs-table-striped-bg: transparent;
  cursor: pointer;
}

tr.repr-section-header > th {
  text-align: left !important;
  vertical-align: middle;
}

.repr-element, tr.repr-element > td {
  opacity: 1;
  text-align: left !important;
}

.repr-element-faded {
  transition: 0.3s ease;
  opacity: 0.2;
}

.repr-element-collapsed {
  display: none;
}

/* Collapse / uncollapse button and the caret it contains. */
.repr-section-toggle-col button {
  cursor: pointer;
  width: 1rem;
  background-color: transparent;
  border-color: transparent;
}

span.collapse-uncollapse-caret {
  width: 1rem;
  height: 1rem;
  display: block;
  background-repeat: no-repeat;
  background-position: left;
  background-size: contain;
}

/* The collapse / uncollapse carets were copied from the free Font Awesome collection and adjusted. */

/* Default to black carets for light mode */
.repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
}

.repr-section-toggle-col
  > button:not(.collapsed)
  > span.collapse-uncollapse-caret {
  background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="black" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
}

/* Use white carets for dark mode */
@media (prefers-color-scheme: dark) {
  .repr-section-toggle-col > button.collapsed > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"/></svg>');
  }

  .repr-section-toggle-col
    > button:not(.collapsed)
    > span.collapse-uncollapse-caret {
    background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="white" d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/></svg>');
  }
}

.channel-names-btn {
  padding: 0;
  border: none;
  background: none;
  text-decoration: underline;
  text-decoration-style: dashed;
  cursor: pointer;
  color: #0d6efd;
}

.channel-names-btn:hover {
  color: #0a58ca;
}
</style>



<table class="repr table table-hover table-striped table-sm table-responsive small">
    







<tr class="repr-section-header general-80579487-2dcf-4c0e-84fb-3fbbe81576b6"  title="Hide section" 
    onclick="toggleVisibility('general-80579487-2dcf-4c0e-84fb-3fbbe81576b6')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>

<tr class="repr-element general-80579487-2dcf-4c0e-84fb-3fbbe81576b6 ">
    <td class="repr-section-toggle-col"></td>
    <td>MNE object type</td>
    <td>Epochs</td>
</tr>
<tr class="repr-element general-80579487-2dcf-4c0e-84fb-3fbbe81576b6 ">
    <td class="repr-section-toggle-col"></td>
    <td>Measurement date</td>
    
    <td>2015-01-20 at 13:15:58 UTC</td>
    
</tr>
<tr class="repr-element general-80579487-2dcf-4c0e-84fb-3fbbe81576b6 ">
    <td class="repr-section-toggle-col"></td>
    <td>Participant</td>
    
    <td>Unknown</td>
    
</tr>
<tr class="repr-element general-80579487-2dcf-4c0e-84fb-3fbbe81576b6 ">
    <td class="repr-section-toggle-col"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="repr-section-header acquisition-63278dcd-8880-4092-babc-d2b203760464" 
    title="Hide section"  onclick="toggleVisibility('acquisition-63278dcd-8880-4092-babc-d2b203760464')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>




<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Total number of events</td>
    <td>519</td>
</tr>


<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Events counts</td>
    
    <td>
        
        CorResp: 138
        <br />
        
        IncorResp: 0
        <br />
        
        Match/A: 18
        <br />
        
        Match/B: 18
        <br />
        
        Match/C: 18
        <br />
        
        Match/D: 18
        <br />
        
        Mismatch/A: 18
        <br />
        
        Mismatch/B: 18
        <br />
        
        Mismatch/C: 17
        <br />
        
        Mismatch/D: 18
        <br />
        
        PicOnset: 142
        <br />
        
        RespFeedback: 1
        <br />
        
        RespPrompt: 95
        <br />
        
        unused: 0
        
        
    </td>
    
</tr>


<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time range</td>
    <td>-0.100 – 1.000 s</td>
</tr>


<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Baseline</td>
    <td>-0.100 – 0.000 s</td>
</tr>


<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Sampling frequency</td>
    <td>500.00 Hz</td>
</tr>


<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Time points</td>
    <td>551</td>
</tr>


<tr class="repr-element acquisition-63278dcd-8880-4092-babc-d2b203760464 ">
    <td class="repr-section-toggle-col"></td>
    <td>Metadata</td>
    <td>No metadata set</td>
</tr>

    







<tr class="repr-section-header channels-9b74b91c-e75d-4741-9973-51a73613984d"  title="Hide section" 
    onclick="toggleVisibility('channels-9b74b91c-e75d-4741-9973-51a73613984d')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


<tr class="repr-element channels-9b74b91c-e75d-4741-9973-51a73613984d ">
    <td class="repr-section-toggle-col"></td>
    <td>EEG</td>
    <td>
        <button class="channel-names-btn" onclick="alert('Good EEG:\n\nFp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz')" title="(Click to open in popup)&#13;&#13;Fp1, F3, F7, C3, P3, TP9, Fz, Cz, Fp2, F4, F8, C4, P4, TP10, Pz, Oz">
            16
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-9b74b91c-e75d-4741-9973-51a73613984d ">
    <td class="repr-section-toggle-col"></td>
    <td>Head & sensor digitization</td>
    
    <td>19 points</td>
    
</tr>
    







<tr class="repr-section-header filters-3642e914-f44a-4187-be30-10219eda2fa2"  title="Hide section" 
    onclick="toggleVisibility('filters-3642e914-f44a-4187-be30-10219eda2fa2')">
    <th class="repr-section-toggle-col">
        <button>
            
            <span class="collapse-uncollapse-caret"></span>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>

<tr class="repr-element filters-3642e914-f44a-4187-be30-10219eda2fa2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Highpass</td>
    <td>0.10 Hz</td>
</tr>


<tr class="repr-element filters-3642e914-f44a-4187-be30-10219eda2fa2 ">
    <td class="repr-section-toggle-col"></td>
    <td>Lowpass</td>
    <td>30.00 Hz</td>
</tr>


</table></div></div>
</div>
<section id="view-autoreject-s-effects">
<h3>View AutoReject’s Effects<a class="headerlink" href="#view-autoreject-s-effects" title="Link to this heading">#</a></h3>
<p>We can plot the rejection log to see which epochs were rejected, and which channels were interpolated:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">reject_log_clean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/822b4d645b40fd0b0773072e9a3bd97955e3914997fb927f9f1c3e1aaf012705.png" src="../_images/822b4d645b40fd0b0773072e9a3bd97955e3914997fb927f9f1c3e1aaf012705.png" />
</div>
</div>
</section>
<section id="visualize-average-erp-after-autoreject">
<h3>Visualize Average ERP After AutoReject<a class="headerlink" href="#visualize-average-erp-after-autoreject" title="Link to this heading">#</a></h3>
<p>Let’s again plot the average ERPs across all Match and Mismatch trials, after AutoReject has been applied. We’ll create a figure with two subplots so we can compare the average before and after data cleaning with ICA + AutoReject:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="c1"># remember the semicolon prevents a duplicated plot</span>
<span class="n">epochs_clean</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">,</span> <span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/aefd4db74dd8b0479520b2f93d07764ecd1d039ec1653bb0a77b0145d1b9033a.png" src="../_images/aefd4db74dd8b0479520b2f93d07764ecd1d039ec1653bb0a77b0145d1b9033a.png" />
</div>
</div>
<p>The data look very similar in the two panels, but there are some differences. In particular, the variability in amplitude across channels is larger prior to artifact removal. Notably, the anterior channels (shown in green/yellow hues) seem to cluster together, and are different in amplitude from other channels. This suggests that there were some ocular artifacts in the later portion of some of the epochs — since ocular artifacts are much larger over anterior than posterior channels. After cleaning, the differences between channels are decreased, providing evidence that the cleaning process had an effect.</p>
<p>It’s also insightful to note here that, in the average across nearly 150 epochs, the ocular artifacts do not look like a “canonical” blink or horizontal eye movement artifact, like the examples shown in the previous lesson. Since ocular artifacts typically don’t occur at the same time relative to stimulus onset, and occur on a (hopefully) small number of trials, in the average their influence is more subtle. However, they can still have a large effect on the data, as we can see here.</p>
</section>
<section id="scalp-topography-maps">
<h3>Scalp topography maps<a class="headerlink" href="#scalp-topography-maps" title="Link to this heading">#</a></h3>
<p>As we did with ICA components, we can plot the EEG potentials over the scalp, using the <code class="docutils literal notranslate"><span class="pre">.plot_topomap()</span></code> method. The code below generates a scalp map every 100 ms, which reflects the electrical potentials averaged over a 50 ms window centered on each time point. The time range over which each plot is averaged are shown in the labels above each scalp plot; the numbers are not precisely 50 ms ranges, because the sampling rate was 500 Hz, meaning that samples were acquired every 2 ms. So we have data at, e.g., .024 and .026 s, but not at .025.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify times to plot at, as [min],[max],[stepsize]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">epochs_clean</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="mf">0.050</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0e99a0bd174e96aea40c781c2aa6abbb2f3ecc95b2df6de04572a00b65a9f128.png" src="../_images/0e99a0bd174e96aea40c781c2aa6abbb2f3ecc95b2df6de04572a00b65a9f128.png" />
</div>
</div>
<p>We can plot the Mismatch trials separately from the Match trials, to see if there are any differences in the scalp topography of the ERPs between the two conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs_clean</span><span class="p">[</span><span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="mf">0.050</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cc63469c5e4379f74910d882111bc347c2b2fd2828e27325abe6c4974874088b.png" src="../_images/cc63469c5e4379f74910d882111bc347c2b2fd2828e27325abe6c4974874088b.png" />
</div>
</div>
<p>There do seem to be differences, but be careful: look at the range of microVolt values in the colorbars for each plot. They are different. By default, MNE scales the range of the colorbar in topo plots to the range of values in each data object that is passed to it. This is useful bin visualizing the scalp distribution of effects in any particular condition, but it makes it impossible to compare between conditions. But to compare between two plots, we need to ensure that the colorbar ranges are the same for both. We can use the <code class="docutils literal notranslate"><span class="pre">vlim</span></code> kwarg to specify the range of values to use for the <em>y</em> axis and colorbar. Here we use the same range for both conditions, so that we can compare them. Since one plot’s range is ±10 µV, and the other is ±6 µV, we use ±8 as a compromise</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Always use a symmetrical pair of values for the <code class="docutils literal notranslate"><span class="pre">vlim</span></code> argument to <code class="docutils literal notranslate"><span class="pre">plot_topomap()</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">(-10,</span> <span class="pre">10)</span></code>, but not <code class="docutils literal notranslate"><span class="pre">(-10,</span> <span class="pre">5)</span></code>). The red-blue color scale that is used assumes that the values are symmetrical, so that values close to zero appear white, positive values are read, and negative values are blue. This is quite intuitive for most viewers to interpret. However, if you use an asymmetric range, then white will not be centered on zero, and the color scale will be misleading.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify times to plot at, as [min],[max],[stepsize]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match&#39;</span><span class="p">)</span>
<span class="n">epochs_clean</span><span class="p">[</span><span class="s1">&#39;Match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="mf">0.050</span><span class="p">,</span> <span class="n">vlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mismatch&#39;</span><span class="p">)</span>
<span class="n">epochs_clean</span><span class="p">[</span><span class="s1">&#39;Mismatch&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="mf">0.050</span><span class="p">,</span> <span class="n">vlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Match
</pre></div>
</div>
<img alt="../_images/b02487bb1da680b56c39e50bd3d4d08974187bd36ece24c7815995b642ebd518.png" src="../_images/b02487bb1da680b56c39e50bd3d4d08974187bd36ece24c7815995b642ebd518.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mismatch
</pre></div>
</div>
<img alt="../_images/1071c5f1f5f9b6aaf4d65fbae63d9072a961bc5c25f1e8fd7bdc9b4c135e398f.png" src="../_images/1071c5f1f5f9b6aaf4d65fbae63d9072a961bc5c25f1e8fd7bdc9b4c135e398f.png" />
</div>
</div>
<p>The differences between conditions appear smaller now, however some differences are still visible. In the next lesson we’ll explore how to visualize differences between conditions in more detail.</p>
</section>
</section>
<section id="save-epochs">
<h2>Save epochs<a class="headerlink" href="#save-epochs" title="Link to this heading">#</a></h2>
<p>Finally, we’ll save our cleaned epochs for use in later lessons. MNE requires the <code class="docutils literal notranslate"><span class="pre">-epo</span></code> suffix for .fif files storing epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs_clean</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="n">p_id</span> <span class="o">+</span> <span class="s1">&#39;-epo.fif&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./7-eeg"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="erp_artifacts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Artifacts in EEG Data</p>
      </div>
    </a>
    <a class="right-next"
       href="erp_avg_reref.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Averaging and Re-Referencing ERPs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-mne-and-read-filtered-data">Import MNE and Read Filtered Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mne-s-events-structure">MNE’s events structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#about-event-codes">About Event Codes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-event-dictionary">The Event Dictionary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-mne-interprets-event-codes">How MNE Interprets Event Codes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#label-event-codes-mapping-between-dictionaries">Label Event Codes – Mapping Between Dictionaries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-events-over-time">Plot Events Over Time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#segment-the-data-into-epochs">Segment the data into epochs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-and-indexing-epochs">Viewing and Indexing Epochs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-average-erp-across-conditions-of-interest-before-artifact-correction">Visualize Average ERP Across Conditions of Interest – Before Artifact Correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-ica-correction-to-epochs">Apply ICA correction to epochs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-average-erp-after-ica-artifact-removal">Visualize Average ERP After ICA Artifact Removal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autoreject-for-final-data-cleaning">AutoReject for Final Data Cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#view-autoreject-s-effects">View AutoReject’s Effects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-average-erp-after-autoreject">Visualize Average ERP After AutoReject</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scalp-topography-maps">Scalp topography maps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-epochs">Save epochs</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aaron J Newman
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-23. This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Unported License.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>